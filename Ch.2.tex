\chapter{Scanning Tunneling Microscopy (STM)}
The invention of the scanning tunneling microscope (STM) marked a turning point in our ability to probe matter at the atomic scale. Unlike conventional microscopes that form images through lenses, STM operates on the principle of quantum tunneling: a sharp metallic tip is positioned within angstroms of a conductive surface, and the resulting tunneling current encodes the local electronic structure with atomic resolution. An intuitive analogy is the way a blind person reads Braille, resolving fine patterns point by point (Figure \ref{fig:braille}a). However, unlike Braille — where touch conveys height variations — STM “feels” the surface electronically, through tunneling electrons rather than mechanical contact (Figure \ref{fig:braille}b).

The key enabling mechanism is quantum tunneling. When the STM tip is brought within a nanometer of the sample surface and a bias voltage is applied, electrons can traverse the vacuum barrier, producing a measurable tunneling current. Because this current is exquisitely sensitive to both tip–sample separation and local electronic states, STM can map surfaces' electronic structure with sub-angstrom resolution.

The first STM was built in 1981 by Gerd Binnig and Heinrich Rohrer at IBM Zurich. In 1982, they used it to image the Si(111) surface, directly resolving the famous 7×7 reconstruction and identifying twelve adatoms within the unit cell (Figure \ref{figure:si111_binnig}) \cite{binnig77Reconstruction1983}; this marked the first time in history that atomic structures were directly visualized. This experiment not only validated the instrument’s unprecedented spatial resolution—down to picometers—but also demonstrated its potential to reveal atomic-scale structure and fundamentally reshape models of surface physics. Soon after, STM development moved beyond imaging alone. By incorporating spectroscopic capability, researchers realized they could probe electronic states as well as atomic positions, adding energy resolution to spatial resolution. This dual sensitivity opened an entirely new window into materials and set the blueprint for its later evolution into the modern spectroscopic-imaging STM. Today, STM provides direct access to point defects, emergent quasiparticles, and exotic surface states in quantum materials—revealing not only how atoms are arranged, but how electrons interact, scatter, and self-organize at the smallest scales.

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{braille.png}
	\caption[\textbf{Analogy between the Braille reading and STM topography}]{\textbf{Analogy between the Braille reading and STM topography}.a) In Braille, fingertips resolve patterns through their sensitivity to spatial variations (Courtesy of the American Foundation for the Blind). b) In STM, an atomically sharp tip scans across a material’s surface, where the tunneling current is modulated by both the surface topography and the local electronic structure. The red atom illustrates how variations in electronic states influence the measured signal, highlighting STM’s dual sensitivity to geometric and electronic features.}
	\label{fig:braille}
\end{figure}

In this chapter, we will first explain the theory of \ac{STM}, then introduce the configuration of a modern \ac{STM}, and close with an introduction on the instrument we used for this study. 


\section{Theory of STM}
In essence, an \ac{STM} works by taking advantage of the spatial dependence of the tunneling current between the tip and sample. Thus, the quantitative understanding of the tunneling current is the core of theory of \ac{STM}, and thus the focus of this section. We will first give an overview about quantum tunneling and its theory development in history, then we will elaborate on the derivation of tunneling current in a typical tip-sample geometry.

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{Si111_binnig.png}
	\caption[\textbf{STM topographic image of the Si(111)-$7 \times 7$ reconstructed surface}]{\textbf{STM topographic image of the Si(111)-$7 \times 7$ reconstructed surface}. The sixfold rotational symmetry around the rhombohedral corners is evident, with twelve adatoms in a unit cell clearly resolved. Crosses mark the adatom positions as proposed in the modified adatom model. Brightness reflects relative height (not to scale). The figure is reprinted with permission from G.~Binnig \textit{et al.}, \textit{Phys. Rev. Lett.} \textbf{50}, 120 (1983)~\cite{binnig77Reconstruction1983}. \textcopyright{} 1983 American Physical Society.}
	\label{figure:si111_binnig}
\end{figure}

\subsection{Quantum tunneling and development of STM theory}
Quantum tunneling refers to the phenomenon where a quantum particle penetrates a potential barrier higher than its energy. More precisely, because of wave–particle duality, the particle’s wavefunction extends into and beyond the barrier, giving a finite probability of finding it in the classically forbidden region. Quantitatively, according to the Wentzel–Kramers–Brillouin (WKB) approximation, the transmission probability $T$ for a particle with mass $m$ and energy $E$, given a potential barrier of height $V$ and width $\alpha$ is: 
\begin{equation}
	T \approx e^{-\alpha\sqrt{\frac{8m}{\hslash^2}(V-E)}}. 
\end{equation}
In fact, according to de Broglie's  matter wave theory, even a classical object could theoretically tunnel through a seemingly forbidden barrier, just extremely unlikely: the probability for a baseball traveling at 40 m/s to tunnel through a 10 cm thick brick wall is approximately $e^{-10^{33}}$. 

The development of a theory of quantum tunneling can be dated to 1928, when Robert Oppenheimer developed a time-dependent perturbation method trying to explain the ionization of hydrogen in an applied field\cite{oppenheimerThreeNotesQuantum1928}. At the same year, Gamow applied quantum tunneling to the Helium atom and developed the theory of alpha decay, which explained how alpha particles escape from heavy, unstable nuclei. A more general theory for a metal-insulator-metal junction was introduced by Bardeen in 1961\cite{bardeenTunnellingManyParticlePoint1961}, 20 years before the birth of \ac{STM}. In 1983, Tersoff and Hamann extended Bardeen's theory to model an ideal STM tip-sample junction, which was used to interpret the topography of a Au crystal \cite{tersoffTheoryApplicationScanning1983,tersoffTheoryScanningTunneling1985}. Later, Lang found that one can effectively model the \ac{STM} operation with tunneling between only the single atom on the end of a tip (the apex atom) and the single atom on the surface, revealing the atomic nature of the \ac{STM} \cite{langVacuumTunnelingCurrent1985,langSpectroscopySingleAtoms1986,langApparentSizeAtom1987}. Inspired by the atomic picture, Julian Chen built a three-dimensional model of the tunneling considering different tip configurations by expanding the asymptotic wave function of the apex atom\cite{chenTunnelingMatrixElements1990,chenTheoryScanningTunneling1988}.  

\subsection{Interpretation of the tunneling current}
According to Fermi's golden rule, the transmission probability between the tip and sample is directly related to the matrix element $M_{ts}$ between the tip's state $\psi_{t}$, sample's state $\psi_{s}$, and their corresponding electron density $\rho$. When a small bias voltage is applied between sample and tip, we can write:
\begin{align}
	P_{t->s} &= \frac{2\pi}{\hslash}\int_{-\infty}^{\infty}|M_{ts}|^2\rho_s(\epsilon + eV_s)[1-f(\epsilon+eV_s)]\cdot \rho_t(\epsilon)f(\epsilon) d\epsilon \\
	P_{s->t} &= \frac{2\pi}{\hslash}\int_{-\infty}^{\infty}|M_{ts}|^2\rho_s(\epsilon + eV_s)f(\epsilon+eV_s)\cdot \rho_t(\epsilon)[1-f(\epsilon)] d\epsilon,
\end{align} 
where $f$ represents the Fermi-Dirac function. It is worth noting that in order to use Fermi's golden rule, an equilibrium condition is assumed; this is generally satisfied as the internal relaxation time scale for metallic electrodes is in the range of femtosecond to picosecond, which is much smaller than milliseconds settling time used in standard \ac{STM} measurements. 

The tunneling current is proportional to the net transmission probability across tip and sample, under one key assumption: the tunneling must not change the occupation number of both the sample and tip side. We can assess the validity of this equilibrium assumption in a typical \ac{STM} setup by comparing the characteristic timescales for electron tunneling (discharging) and charge relaxation (refilling). For a metallic tip such as tungsten, typical tunneling currents in the pico- to nano-ampere range imply an electron flow of $10^{6}$ to $10^{9}$~s\textsuperscript{-1}, corresponding to a discharging interval of approximately $\tau_{\text{discharge}} \approx 10^{-9}$~s. Conversely, the recharging timescale is governed by the plasma frequency $\omega_{p}$, which dictates the screening response of the Fermi gas. For tungsten, $\omega_{p} \approx 10^{16}$~s\textsuperscript{-1}, yielding a relaxation time of $\tau_{\text{charge}} \approx 10^{-16}$~s. Since $\tau_{\text{charge}} \ll \tau_{\text{discharge}}$, the apex atom remains in electron occupation equilibrium with the reservoir. A similar condition applies to the sample surface; however, for lower-conductivity materials such as semiconductors, the charge relaxation rate may be insufficient. In these non-equilibrium regimes, a significant portion of the potential drops within the sample itself, manifesting as tip-induced band bending---an effect that requires careful consideration when interpreting~\cite{feenstraInfluenceTipinducedBand2006}.

Having evaluated this assumption, we can then write the tunneling current $I_t$:
\begin{align}
	I_t & = 2e(P_{t->s}-P_{s->t})\\
	& = 2e \cdot \frac{2\pi}{\hslash}\int_{-\infty}^{\infty}|M_{ts}|^2\rho_t(\epsilon) \rho_s(\epsilon + eV_s) \cdot[f(\epsilon) - f(\epsilon + eV_s)] d\epsilon.
\end{align}
The factor of 2 is a result of the spin degeneracy. At low temperature, when $k_BT\ll V_s$, we can replace the Fermi-Dirac distribution function $f$ with a step-wise function, and simplifies the integral to: 
\begin{equation}
	\label{eq:I_t}
	I_t = \frac{4e\pi}{\hslash}\int_{0}^{eV_s}|M_{ts}|^2\rho_t(\epsilon - eV_s) \cdot \rho_s(\epsilon)d\epsilon. 
\end{equation} 
From Equation \ref{eq:I_t}, we note that the tunneling current is proportional to both $\rho_t$ and $\rho_s$, since we are interested in probing the sample, we can carefully pick the tip to have a featureless $\rho_t$ near the Fermi level. This can be achieved by using simple metal and their alloys; typically, \ac{STM}s today use tips made of tungsten or a platinum-iridium.


\vspace{1em}
\noindent\textbf{Approximating the matrix elements}

\noindent In a semiclassical picture with WKB approximation, by estimating the transmission probability through a square barrier of height $\Phi = (\Phi_t + \Phi_s)/2$, where $\Phi_t$ and $\Phi_s$ are the work function for the tip and sample respectively, we can get the matrix element $M_{ts}$, such that: 
\begin{equation}
	|M_{ts}|^2 = e^{-2\kappa d},
\end{equation}
where $\kappa = \sqrt{2m\Phi}/\hslash$.

However, the quantum mechanical determination of the matrix element is much more complex. Intuitively, it can be pictured as the overlapping of sample wave function and tip wave function within the insulating barrier. Here, I will follow the historical development to show how the matrix element is determined. Bardeen first made a significant leap by formulating a general expression for a metal–insulator–metal junction under a few key assumptions. Later, Tersoff and Hamann applied this framework to the idealized STM setup, featuring a sharp tip facing a flat sample surface.

"The way to derive Bardeen's tunneling theory is not straightforward; it does not proceed by routine application of textbook techniques"~\cite{gottliebBardeensTunnelingTheory}. Here I follow the approach of Gottlieb and Wesoloski~\cite{gottliebBardeensTunnelingTheory}, which was mostly inspired by C.~B.~Duke \cite{dukeTunnelingSolids1973}. The readers are encouraged to read the full derivation in this comprehensive and accessible tutorial by Gottlieb and Wesoloski~\cite{gottliebBardeensTunnelingTheory}. 

To start, we can first write the general expression of matrix element in real space: 
\begin{equation}
	\label{eq:bardeen_1}
	\braket{\phi_{\mu}|H-H_s|\psi_{\nu}} = \int(V(\mathbf{r})- V_s(\mathbf{r})\phi^*_{\mu}(\mathbf{r})\psi_{\nu}(\mathbf{r}))dr,
\end{equation}
where $\phi_{\mu}$ and $\psi_{\nu}$ are the eigenstates of the tip Hamiltonian $H_t$ and sample Hamiltonian $H_s$, respectively. That is $H_t \phi_{\mu} = \epsilon_{\mu} \phi_{\mu}$, and $H_s \psi_{\nu} = E_{\nu} \psi_{\nu}$. Note that this is a key assumption in Bardeen's formalism, that the junction is in the weak tunneling condition, ie, the sample potential ($V_s$) and the tip potential $V_t$ do not penetrate into each other. 

Bardeen then artificially separated the barrier region into two parts by drawing a "separation surface" $\mathbf{S}$; the volume that is close to the tip side is denoted as $\mathbf{T}$, and $\mathbf{S} = \partial \mathbf{T}$.

We can then observe that the total Hamiltonian $H$ is equal to the tip Hamiltonian $H_t$ in region $\mathbf{T}$ due to the absence of sample potential $V_s$, that is $H-H_t$ is an zero operator in T, we thus can write
\begin{equation}
	\label{eq:bardeen_2}
	\begin{aligned}
		0 &= \int_{T}  \psi_{\nu}(\mathbf{r}) \left( H - H_{t} \right) \phi_{\mu}^*(\mathbf{r})  \, d\mathbf{r} \\
		&= \int_{T} \psi_{\nu}(\mathbf{r}) H \phi_{\mu}^*(\mathbf{r})  \, d\mathbf{r} 
		- E_{\mu} \int_{T}   \psi_{\nu}(\mathbf{r})\ \phi_{\mu}^*(\mathbf{r}) d\mathbf{r} \\
		&= -\frac{\hslash^2}{2m} \int_{T}   \psi_{\nu}(\mathbf{r}) \Delta \phi_{\mu}^*(\mathbf{r}) \, d\mathbf{r} 
		+ \int_{T} \psi_{\nu}(\mathbf{r}) V(\mathbf{r}) \phi_{\mu}^*(\mathbf{r}) \, d\mathbf{r} 
		- E_{\mu} \int_{T}  \psi_{\nu}(\mathbf{r}) \phi_{\mu}^*(\mathbf{r})\, d\mathbf{r}.
	\end{aligned}
\end{equation}
And similarly, $H - H_s$ is a zero operator in the barrier region that is not $\mathbf{T}$. Thus the integral in Equation \ref{eq:bardeen_1} can be reduced to region $\mathbf{T}$:   
\begin{equation}
	\label{eq:bardeen_3}
	\begin{aligned}
		&\langle \phi_{\mu} | H - H_{\text{s}} | \psi_{\nu} \rangle \\
		&= \int_{T} \phi_{\mu}^*(\mathbf{r}) \left( H - H_{\text{sam}} \right) \psi_{\nu}(\mathbf{r}) \, d\mathbf{r} 
		= \int_{T} \phi_{\mu}^*(\mathbf{r}) H \psi_{\nu}(\mathbf{r}) \, d\mathbf{r} 
		- \epsilon_{\nu} \int_{T} \phi_{\mu}^*(\mathbf{r}) \psi_{\nu}(\mathbf{r}) \, d\mathbf{r} \\
		&= -\frac{\hslash^2}{2m} \int_{T} \phi_{\mu}^*(\mathbf{r}) \Delta \psi_{\nu}(\mathbf{r}) \, d\mathbf{r} 
		+ \int_{T} \phi_{\mu}^*(\mathbf{r}) V(\mathbf{r}) \psi_{\nu}(\mathbf{r}) \, d\mathbf{r} 
		- \epsilon_{\nu} \int_{T} \phi_{\mu}^*(\mathbf{r}) \psi_{\nu}(\mathbf{r}) \, d\mathbf{r}.
	\end{aligned}
\end{equation}
Subtracting Equation \ref{eq:bardeen_2} from Equation \ref{eq:bardeen_3}, we get: 
\begin{equation}
	\label{eq:bardeen_matrixelement}
	\begin{aligned}
		\braket{\phi_{\mu}|H-H_s|\psi_{\nu}} &= \int_\mathbf{T}\phi_{\mu}^*(\mathbf{r})(-\frac{\hslash^2}{2m} \nabla \psi_{\nu}(\mathbf{r}) - \epsilon_{\nu}\psi_{\nu}(\mathbf{r}))dr \\ 
		& - \int_\mathbf{T}\psi_{\nu}(\mathbf{r})(-\frac{\hslash^2}{2m} \nabla \phi_{\mu}^*(\mathbf{r}) - E_{\mu}\phi_{\mu}^*(\mathbf{r}))dr.
	\end{aligned}
\end{equation}
By considering only $\epsilon_{\nu} \approx E_{\mu}$, we can get:
\begin{align}
	\label{eq:bardeen4}
	\braket{\phi_{\mu}|H-H_s|\psi_{\nu}} &\approx -\frac{\hslash^2}{2m}\int_\mathbf{T}\nabla \cdot [\phi_{\mu}^*(\mathbf{r})\nabla\psi_{\nu}(\mathbf{r})-\psi_{\nu}(\mathbf{r})\nabla\phi_{\mu}^*(\mathbf{r})]dr\\ \label{eq:bardeen5}
	& = -\frac{\hslash^2}{2m}\int_{\partial\mathbf{T}}[\phi_{\mu}^*(\mathbf{r})\nabla\psi_{\nu}(\mathbf{r})-\psi_{\nu}(\mathbf{r})\nabla\phi_{\mu}^*(\mathbf{r})]\cdot d\mathbf{n}.
\end{align}

The volume integral is reduced to the surface integral on $\partial \mathbf{T} = \mathbf{S}$ via the divergence theorem in vector calculus. This results in Bardeen's approximation of the matrix element, where $\mathbf{n}$ represents the normal vector of $\mathbf{S}$, pointing away from the tip region.  

Tersoff and Hamann took Equation \ref{eq:bardeen5} and applied it to the \ac{STM}. They considered the sample being a periodic crystal, with the sample states following a Bloch wave in the x-y plane. The states are weighted by an exponentially decreasing decay factor and the sample wave function $\psi_{\nu}(r)$ can be expressed as:
\begin{equation}
	\label{eq:sample_wavefunction}
	\psi_{\nu}(r) = \sum_G C_{k_{||},G} e^{-\alpha_{\nu,G}\cdot z }e^{i(k_{||}+G)x},
\end{equation}
where $K_{||}$ is the component of wave vector that is parallel to the surface. $G$ is the in-plane reciprocal lattice wave vector. And $\alpha_{n,G} = \sqrt{|k_{||}+G|^2 + \kappa_{\nu}^2}$, where $\kappa_{\nu} = \sqrt{2m(\Phi_s - E_{\nu})/\hslash^2}$ and $\Phi_s$ is the work function of the sample. 

The tip end was assumed to be locally spherical with a radius of R centered at tip center $\mathbf{r_0}$. The tip wave function outside of the tip region can be modeled as:
\begin{equation}
	\label{eq:tip_wavefunction}
	\phi_{\mu}(r) = A_{\mu} \frac{e^{-\kappa_{\mu} |\mathbf{r-r_0}|}}{|\mathbf{r-r_0}|},
\end{equation}
With $\kappa_{\mu} = \sqrt{2m(\Phi_t-\epsilon_{\mu})/\hslash^2}$. A schematic of the set up is shown in Figure.\ref{fig:tersoff}. 
\begin{figure}
	\centering
	\includegraphics[width=0.5\textwidth]{STM_Tip_Tersoff-Hamann model.png}
	\caption[\textbf{Schematics of the tunneling geometry in the Tersoff–Hamann model}]{\textbf{Schematics of the tunneling geometry in the Tersoff–Hamann model} The probe tip is approximated as locally spherical with radius of curvature $R$, centered at $\mathbf{r_0}$, where it approaches the surface at the nearest distance $d$.}
	\label{fig:tersoff}
\end{figure}

They then plug Equation \ref{eq:sample_wavefunction} and \ref{eq:tip_wavefunction} into Equation \ref{eq:bardeen5}. By smartly picking the separation surface to be close to the tip apex, they get the matrix element: 
\begin{equation}
	\label{eq:matrixelement_final}
	M_{\mu \nu} = -\frac{2\pi\hslash^2}{m}A_{\mu}\psi_{\nu}(\mathbf{r_0}).
\end{equation}

The final expression for the matrix element is proportional to the sample's surface wave function at the center of the tip. This is the fundamental reason why \ac{STM} is considered a local probe. Moreover, $A_{\mu}$ contains the exponential decay term; the decay length is often sub-angstrom, reflecting that the tunneling current is extremely sensitive to tip-sample distance. 

We now recall that in the weak tunneling limit, the low-temperature net tunneling current is given by Equation \ref{eq:I_t}:
\begin{equation}
	I = \frac{4\pi e}{\hslash} \int_0^{eV}|M_{\mu \nu}|^2 \rho_t(\epsilon - eV) \cdot \rho_s(\epsilon) d\epsilon.
\end{equation}
we plug in the matrix element \ref{eq:matrixelement_final} and get:
\begin{equation}
	I(V) \propto \int_0^{eV}  \rho_s(\mathbf{r_0},\epsilon) \rho_t(\epsilon-eV) d\epsilon,
\end{equation}

where $\rho_s(\mathbf{r_0},\epsilon) = \sum_{\nu} |\psi_{\nu}(\mathbf{r_0})|^2 \delta(\epsilon - E_{\nu})$, is the local density of state (LDOS) of the sample at the tip center. We then substitute $E = E_F+ \epsilon - eV$. And at the low bias regime, the electron density of tip near the Fermi level can be seen as constant, we thus have: 
\begin{equation}
	I(V) \propto \int_{E_F}^{E_F+ eV}  \rho_s(\mathbf{r_0},E) dE,
\end{equation}

We can further take the derivative of the current with respect to the voltage, and get: 
\begin{equation}
	dI/dV \propto \rho_s(\mathbf{r_0},E_F + eV),
\end{equation}

\begin{equation}
	dI/dV \propto \rho_s(\mathbf{r},E_F + eV),
\end{equation}
which sets the theoretical foundation for Scanning Tunneling Spectroscopy(STS) as a measurement of the sample's \ac{LDOS}. 

\section{Configuration of an STM}
There are four components of a typical STM: they are tip-sample junction, the motion control system, feedback loop $\&$ controller, and environment control system. 

The tunneling tip-sample junction is the central component, it is made of a metallic tip and a conductive flat sample. Fresh sample surfaces are typically cleaved in-situ and immediately transferred to the STM chamber, the whole process is done under \ac{UHV} environment to minimize contamination from residual gas molecules. It is then mounted on a stage that allows precise positioning relative to the tip. Tips are normally made of Tungsten or Platinum-Iridium wires. Electrical etching or mechanical cutting can yield apexes that are sharp under the optical microscope. Due to the atomic nature of \ac{STM} measurements, an atomically sharp tip with a desirable metal atom on its apex is wanted. To achieve that, several in-situ methods can be employed: high-temperature annealing, which removes adsorbates and relaxes surface stress by heating the tip in UHV; electric field emission, where a strong field of a few voltage per nanometer along tip's axial direction reorganizes surface atoms at the apex into a sharper geometry; controlled crashing, which briefly drives the tip into a noble metal surface (in our study, it is coin gold) or applies voltage pulses to modify the apex by material transfer; and ion sputtering, where an ion beam bombards the tip to clean and sharpen the apex. All methods above are used in this study. It is worth noting that each method can also carry drawbacks: annealing and field effects may blunt the tip if overdone, sputtering can induce stress or damage, and crashing risks uncontrolled tip–sample material transfer. In the end, few tip-shaping protocols can consistently produce sharp and stable tips. Instead, STM experimentalists often rely on a trial-and-error process, repeatedly scanning after each treatment to assess the tip state. This iterative approach eventually yields a suitable sharp tip, but the time required can range from days to weeks.



The motion of an STM tip is driven by a set of piezoelectric scanners. Piezoelectricity is the ability of certain materials to generate a electric potential when a mechanical stress is applied. Inversely, when an electric field is applied, piezoelectric material causes mechanical deformation. A typical piezoelectric material used in STM is PZT .(Lead zirconate titanate), which exhibits a high piezoelectric sensitivity. With typical displacement coefficients on the order of a few picometers per volt, sub-angstrom control of the STM tip position is allowed using modest driving voltages. Moreover, PZT also has rigid mechanical property and low thermal expansion, which are essential for durable operations across a wide temperature range.
 \begin{figure}
 	\centering
 	\includegraphics[width=0.8\textwidth]{STM_schematic.png}
 	\caption[\textbf{Schematic of a typical STM setup}]{\textbf{Schematic of a typical STM setup}. 
			Right: The tip–sample tunneling junction, consisting of a metallic tip (commonly W or Pt–Ir) brought within atomic distance of a clean, conductive sample surface prepared under UHV conditions. 
 			Middle: The STM head, roughly the size of a human fist, contains the piezoelectric scanner that provides sub-angstrom control of the tip motion. 
 			Left: Control electronics, including the bias source, current amplifier, and PID feedback circuit, regulate the tunneling current and tip–sample distance during operation. 
 			Together with vibration isolation, cooling, and vacuum systems, these components form the complete STM instrument. 
 			Figure reproduced from Brandon Stuart's Ph.D. thesis~\cite{stuartScanningTunnellingMicroscopy2021}, licensed under  \href{https://creativecommons.org/licenses/by-nc-nd/4.0/}{CC BY-NC-ND 4.0}. No changes were made.
 	}
 	\label{fig:stm_schematics}
 \end{figure}
 
A set of controllers is used to apply bias voltage, monitor the tunneling current and manipulate the motion of the tip. A DC bias voltage is applied across the tip and sample. The experimental setup in this thesis applied the bias voltage to the sample while grounding the tip. Feedback electronics with a proportional-integral-derivative (PID) feedback mechanism are employed to keep the tunneling current stable during scanning. In the constant-current mode of scanning, if the current falls, the tip is driven closer to the surface; if it rises above the setpoint, the controller retracts the tip slightly. In this way, the recorded motion of the tip follows the surface's topographic and electronic structure. The measured tunneling current ranges from pA to a few nA; thus another key component in the controller circuit is a current amplifier with low-noise and high-gain. Typically, a gain of $10^9-10^{10}$ is used, and a series of filters are used after amplification to reduce the noise. 

To connect the three components mentioned above to a complete \ac{STM} set up, a schematic is shown in Figure \ref{fig:stm_schematics}. From left to right, they represent different components at various scales. It is worth mentioning that while an \ac{STM} machine can take up a room of tens of square meters, the size of the \ac{STM} head is often similar to a fist of an adult, as shown in the Figure \ref{fig:stm_schematics} middle panel.

Apart from these three major components, modern \ac{STM} are often equipped with a set of support systems to control the operational environment. This typically includes a pumping system to maintain the UHV conditions in the chamber, a cooling system to reach cryogenic temperatures for improved stability and spectroscopic resolution, and a mechanical damping system to isolate the microscope head from vibration noise. Together, these systems ensure that the tunneling junction remains clean, stable, and free from external disturbances, which is essential for achieving atomic-scale resolution in measurements that truly reflect the intrinsic properties of the system under study.  

\subsection{\ac{STM} measurements}

Recall that the tunneling current can be expressed as:  
\begin{equation}
	I(V,\mathbf{r}) \propto \int_{E_F}^{E_F+eV}\rho_s(\mathbf{r},E)dE. 
\end{equation}

\noindent The bias voltage $V$ and tip displacement $\mathbf{r}$ dependence of the tunneling current give arise to the two basic operational modes of the \ac{STM}. The first mode is topography: given a constant bias voltage, the tunneling current is solely determined by the \ac{LDOS} at the tip location $\mathbf{r}$. We can further express $\mathbf{r} = \mathbf{r_{||}} + r_z \hat{z}$, and since we wish to explore the in-plane landscape of the sample, we will for sure modify $\mathbf{r_{||}}$, and sets up a direct dependency between the tip height $r_z$ and the tunneling current. This give arise to two different ways to probe the surface landscape: fix the current while the tip height is modified with the feedback loop and recorded; or turn off the feedback loop and scan with a constant height while recording the current.While both constant-current and constant-height modes can be used to probe surface topography, each entails distinct advantages and limitations. Constant-height mode is most effective on atomically flat surfaces. However, when significant height variations are present, the tip risks colliding with surface protrusions, potentially damaging the tip apex. This makes constant-height imaging unsuitable for exploring unknown or rough terrains. Furthermore, because the tunneling current depends exponentially on the tip–sample separation, height variations lead to large contrast differences that complicate image interpretation. By contrast, constant-current mode employs a feedback loop to adjust the tip height dynamically, allowing stable imaging of more complex surfaces. Nevertheless, improper tuning of the PID control can introduce noise and signal artifacts. In practice, the preservation of the tip apex—whose preparation at atomic sharpness is both difficult and crucial—combined with the relative ease of data interpretation, makes constant-current mode the predominant choice for topographic imaging in STM. 

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{topographic_modes.png}
	\caption[\textbf{Schematic of the two basic STM topographic imaging modes}]{\textbf{Schematic of the two basic STM topographic imaging modes}. Top: constant-height mode, where the tip height is fixed and the tunneling current varies with tip position. Bottom: constant-current mode, where a feedback loop maintains constant current by adjusting the tip height. In both cases, the measured “height” reflects variations in the local density of states (LDOS) as well as geometric surface corrugation, such that atomic defects with modified DOS appear as apparent topographic features. Figure reproduced from Brandon Stuart's Ph.D. thesis~\cite{stuartScanningTunnellingMicroscopy2021}, licensed under  \href{https://creativecommons.org/licenses/by-nc-nd/4.0/}{CC BY-NC-ND 4.0}. No changes were made.}
	\label{fig:topo_modes}
\end{figure}

The second mode of operation is \ac{STM} spectroscopy: when we park the tip at a fixed position $\mathbf{r_0}$ within the tunneling region, and record the current while scanning the bias voltage. The result of such a measurement is an $I-V$ curve at $\mathbf{r} = \mathbf{r_0}$; by taking its derivative with respect to the voltage, we get the differential conductance, which is proportional to the sample's local electron density of state $\rho_s(\mathbf{r_0}, E_F+eV)$. Another way to obtain the LDOS is through the use of a lockin-amplifier, which modulates the applied DC bias voltage $V_b$ by a sinusoidal AC voltage $V_{lockin}$.  $V_{lockin}$ normally has an amplitude of a few meV and a frequency $\omega$ ranging from a few hundred Hz to a few kHz. The extracted current response at $\omega$ is proportional to the differential conductance. The use of lock-in amplifier is particular useful in a noisy environment, since we can choose the lock-in frequency away from any noise peaks. This allows us to recover signal orders of magnitude smaller than the noise floor. However, despite being a powerful method, the use of lock-in detection requires careful consideration. The most significant challenge is modulation broadening: the applied AC bias averages the signal over an energy window, which can smear out sharp spectral features and limit energy resolution. Another precaution concerns the phase setting: although the lock-in phase is tunable, any lag, whether from capacitance in the wiring or from the junction response time, must be accounted for to ensure the correct phase is applied; otherwise, the signal amplitude can be reduced. Finally, the high sensitivity of lock-in detection often relies on long integration times, which can slow down measurements and make them less suitable for systems with significant drift or limited cryogenic holding time.

The spatial and energy resolution of \ac{STM} can be unified through spatially resolved \ac{STS}, in which local tunneling spectra are acquired at multiple points across the surface on a predefined two-dimensional grid. This procedure yields a three-dimensional dataset, commonly referred to as a grid map, where two axes represent in-plane real-space coordinates and the third axis corresponds to energy (or bias voltage). Such a dataset provides simultaneous access to spatial variations and energy dependence, thereby capturing the full electronic landscape of the material. Owing to this richness, grid map spectroscopy has become a powerful mode of \ac{STM} for studying spatially resolved features of the local density of states (\ac{LDOS}). Grid maps have been widely employed to probe emergent collective orders, such as charge- and spin-density waves, which appear as periodic modulations of the \ac{LDOS}. They also capture quasiparticle interference (QPI) patterns, enabling the reconstruction of electronic band dispersions in metals, semimetals, superconductors, and topological materials\cite{avrahamQuasiparticleInterferenceStudies2018}. In correlated electron systems, grid maps reveal spatial inhomogeneities, including variations in the superconducting gap of high-$T_c$ cuprates\cite{duanSingleparticleTunnelingSpectroscopy2021, boyerImagingTwoGaps2007} and localized states within vortex cores of type-II superconductors\cite{panSTMStudiesElectronic2000, suderowImagingSuperconductingVortex2014}. At the atomic scale, they excel in resolving bound states attached to individual defects, ranging from donor or acceptor states in semiconductors\cite{mahieuDirectEvidenceShallow2005} to in-gap resonances near magnetic impurities\cite{schneiderMagnetismIngapStates2019, yangIngapQuasiparticleExcitations2013, chatzopoulosSpatiallyDispersingYuShibaRusinov2021}.

This study focuses on revealing defect-specific information, and all three modes are used with different focus. Topographies are used to probe the spatial profiles and local distributions for different types of defects; these local distributions are used to calculate defect-specific populations. Point spectroscopies are taken to identify the defect-specific electronic structures. Grid maps are taken on regions with multiple defects to uncover their scattering patterns across different materials; they were then fed into the newly developed algorithm to resolve defect-specific \ac{QPI} features. 

\section{STM used in this thesis project}
In this study, a commercial STM made by SPS-CreaTec GmbH (Createc for short) is used. It is a low-temperature, ultra-high vacuum STM system consisting of a load lock chamber for sample transfer, a preparation chamber for tip and sample treatments, a dual cryostat with an inner Liquid Helium dewar and the outer Liquid Nitrogen sleeve, and most importantly, the main STM chamber and the STM head. 

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{STM_head_piezo.png}
	\caption[\textbf{Overview of the Createc STM system and head design}]{\textbf{Overview of the Createc STM system and head design}.(a) Photograph of the system, showing the preparation chamber (PREP), the STM chamber, and the cryogenic shield. The manipulation arm, located to the left of the PREP chamber, is not visible in the photo. (b) Core components of the Besocke-style STM head: three upright coarse piezoelectric legs (C) support the copper plate, while the scanner piezoelectric tube (S) is mounted upside down and attached to a three-part copper ramp, each section covering 120$\degree$. The slight slope of the ramp allows controlled rotation, enabling fine adjustment of the tip height.}
	\label{fig:STM_head}
\end{figure}

A photo of the system is shown in Figure \ref{fig:STM_head} panel (a), which highlights three major components: the preparation chamber (PREP), the STM chamber, and the cryogenic shield. The manipulation arm, located to the left of the PREP chamber, is not visible in the photo. The STM head, manufactured by Createc, adopts a Besocke-style design \cite{besockeEasilyOperableScanning1987b}. This design differs from the Pan-type STM head in the configuration of its piezoelectric stacks. The core of the head is shown in panel (b): three coarse piezoelectric legs stand upright (labeled “C”), and the scanner piezoelectric tube is mounted upside down and attached to the copper ramp (labeled “S”). During operation, the tip is fixed to the end of the scanner tube, with its apex facing downward, while the scanner enables three-axis, sub-angstrom motion of the tip. The sample is mounted opposite the tip and remains stationary relative to the head frame. On the sample side, three coarse piezoelectric tubes are positioned beneath the copper plate, controlling its motion. The copper plate rests in direct contact with sapphire balls located at the tops of the coarse tubes. This arrangement allows for slip-stick motion, which produces relative movement between the copper plate and the coarse tubes. Each coarse piezoelectric cylinder has four thin metallic electrodes coated on its sides, oriented along the $\pm x$ and $\pm y$ directions. By applying different high voltages across the $x$–$y$ axes, each tube can be bent in any in-plane direction. Finally, the contact surface between the sapphire balls and the copper plate has a slight slope; by driving all three coarse tubes in the same angular direction, the copper plate can be rotated, allowing precise adjustment of the tip height.

The coarse z-range is determined by the size and slope of the copper plate. In the case of this Createc \ac{STM}, we have a coarse z-range of about 0.6 mm, very short compared to the pan-type STM. This limited z-range sets a tight constrain to the tip-sample distance. Figure. \ref{fig:Createc-tip-sample-junction} shows a schematic of the junction when the tip is maximally retracted. The tip holder has a standardized shape but the tip length $Z_t$ can be tuned. On the sample side, while the sample stage and plate are fixed, height of the mushroom-shape sample holder $Z_m$ can be adjusted. According to the manufacturer, distance $Z_t + d +Z_m$ should be 11.6mm. However, the sample stage was found to have an offset of around +0.25 mm, which leaves the distance $Z_t + d +Z_m$ to be 11.35mm, this has been found consistent during the course of this study. To ensure a successful tip landing, the tip-sample distance $d-Z_s$ should be kept within 0.6 mm. Ideally, to allow the maximum traveling range in z-direction, we want $(d-Z_s) \in [0.2,0.4]$mm. This raised two complexities: first, $Z_s$ is the sample height post-cleaving, which is hard to estimate especially when the pre-cleaving sample is thick. Second, given an estimated $Z_s$, we need to ensure $(Z_t+Z_m)\in[10.95-Z_s, 11.15-Z_s]$mm, which needs to be achieved by fine-tuning both the tip height and sample holder height.  

\begin{figure}
	\centering
	\includegraphics[width=0.8\textwidth]{Createc_sample_tip_junction.png}
	\caption[\textbf{Schematic of the STM tip-sample junction with the tip maximally retracted}]{\textbf{Schematic of the STM tip-sample junction with the tip maximally retracted}. The tip holder has a standardized shape but allows adjustment of the tip length $Z_t$. On the sample side, the stage and plate are fixed, while the height of mushroom-shaped holder $Z_m$ can be tuned. Together, these components determine the effective tip–sample spacing, which must be carefully balanced to ensure a successful landing and provide sufficient traveling range along the vertical direction.}
	\label{fig:Createc-tip-sample-junction}
\end{figure}

The core advantage of the Besocke design is its robustness against thermal expansion/contraction and drifts. Lateral drift is canceled by symmetry: the three piezo legs expand equally but are oriented 120° apart, so their outward shifts sum to zero at the geometric center where the tip–sample junction sits. The scanner piezo tube and coarse piezeo tubes are equal in length and are made of the same piezoelectric material; and they are anchored on the tip and sample sides, respectively. This opposite anchoring minimizes vertical drift, as thermal expansion is equal in magnitude but opposite in direction, thereby canceling out. Together, this geometry transforms thermal expansion into common-mode motion rather than relative drift, greatly stabilizing the junction. This is why a lot of temperature dependent measurements are done in this system\cite{chiScanningTunnelingSpectroscopy2012}. 

Createc has a cryogenic holding time of approximately four days at its base temperature of 4.4 K. With the support of a pumping system, the STM chamber remains under UHV at a typical pressure of $10^{-10}$mbar. For each run of experiment, a electrochemically etched tungsten tip is used. After being transferred into the preparation chamber, the tip typically undergoes a series of tip treatment processes including Ar\textsuperscript{+} sputtering, thermal annealing with accelerated electron beams. In STM chamber, the tip can also be treated by performing field emission on a noble metal on the sample holder. 

Createc \ac{STM} was functioning well from the beginning of the study to May 2023, when its dry scroll pump experienced a catastrophic failure, likely due to lack of service. Soon after the scroll pump seized, the turbo molecular pump shut itself due to overheating, this resulted in a rapid drop in vacuum quality in both preparation and STM chambers. Before the ion pumps shut itself, the high voltage across it induced arcing in bad vacuum and caused various shorts in the circuit and other issues. I thus performed a major repair that spanned one and a half years, together with the help from LAIR postdoc Dr. Markus Altthaler. 
