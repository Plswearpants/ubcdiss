\chapter{Quasiparticle Interference (QPI)}
%todo: to write the abstract of this chapter after finishing this chapter
%todo: to standardize the vector form in this chapter 
Quasiparticle interference is a technique used in STM to 
\section{Introduction to Quasiparticle}
Quasiparticle is any long-lived, well-defined excitation in a system that behaves like a particle, it is a semi-classical term used to describe particle interactions in terms of renormalized single-particle excitation. In Fermionic systems, it correspond to a sharp peak in the spectra function: 
	\[
	A(\mathbf{k}, \omega) = -\frac{1}{\pi} \frac{\operatorname{Im} \Sigma(\mathbf{k}, \omega)}{(\omega - \tilde{E}_{\mathbf{k}})^2 + [\operatorname{Im} \Sigma(\mathbf{k}, \omega)]^2},
	\]

This section aims to introduce the concept of quasiparticle, first through a historical overview of the development of quasiparticle theory, relevant languages and terms will be established, as well as the assumptions and limitations of the theory; then we illustrate the concept quantitatively through a microscopy theory of landau quasiparticles. 

\subsection{The historical overview}
The development of quasiparticle model for Fermionic system started in 1940s, when Sommerfeld and Bethe\cite{SommerfeldBethe1933} developed a model for non-interacting electron gas, also known as the 'Fermi gas', in which a series of important terms are introduced. Consider a system made of non-interacting electrons with momentum $k$ and spin $\sigma = 1/2$, and is in touch with an electron reservoir with chemical potential $\mu$. The occupation number naturally follows the Fermi-Dirac distribution $n_{k,\sigma}=1/(1+e^{(k^2/(2m)-\mu)/T}))$. At $T=0$, the occupation thus has a sharp boundary famously known as the Fermi surface, in the momentum space confined by the Fermi wave number $k_f$, and the energy defined by the Fermi surface is called the Fermi energy. At non-zero temperature, electrons at the Fermi energy will started to be excited to above the Fermi energy, this excitation can also be described in second-quantization by the creation of a quasiparticle with energy: $\epsilon_{k,sigma} = k^2/2m - \mu$. 

Sommerfeld's theory of electron gas worked quite well in normal metallic systems, but the success is unexpected, as the model neglected the Coulomb interaction between electrons. In a metallic system where the electron separation is in the order of lattice spacing, the Coulomb interaction is in the order of eV, which is much larger than other, say the thermal excitation considered in the electron gas mode. 

In late 1960s, Landau raised a theory of Fermi liquid with a series of foundational papers\cite{Landau1956}\cite{Landau1957}, to address that even in the presence of interactions, we can find fermionic excitations in these many-body systems, and describe these excitations with what is known as the Landau quasiparticles. By adding a time variant interaction term, defined by time constant $\zeta$ to the non-interactive system, and constructing the system Hamiltonian as
\begin{equation}\label{adiabatic}
	H_{\zeta} = H_0 + H_{\text{int}} e^{-\zeta t}, \quad t > 0,
\end{equation}

By the principle of adiabatic continuity, Landau is able to bridge between the states of interactive and non-interactive system. The consequence is that the states describing interactive system can now be reduced to states in the non-interactive system with the same quantum numbers $k, \sigma$. More specifically, as quoted from \textit{What is a Quasi-Particle?} by J.R.Schrieffer, "these many-body states are well characterized in terms of a set of elementary excitations, called quasi-particles, which for the interacting system play the same role as the excited electrons(above the Fermi surface) and the excited holes(below the Fermi surface) in the Independent-particle approximation(IPA)". 

Landau's quasiparticle is an extremely useful concept in computing the screening and the transport properties of an electron-gas-like system. However, we should emphasis that the theory is only valid with several assumptions:

For adiabatic procedure to hold, time scale $\zeta$ in \ref{adiabatic} should be bounded by two conditions: 1. rate of evolution should be small compared to the energy of the state: $\zeta << \epsilon_{k,\sigma}$, 2. the final bound state remains the same as the initial one, meaning the lifetime $\tau_{life}$ of the bound state should be long enough: $\tau_{life} >> \zeta^{-1}$. Therefore, $\zeta$ should suits: 
\begin{equation}
	\tau_{life}^{-1} << \zeta << \epsilon_{k,\sigma},
\end{equation}
since typical excited energy is in the order of temperature, and the lifetime is inversely proportional to $T^2$, we can also write:
\begin{equation}
	T^2 << \zeta << k_B T,
\end{equation}
This requirement can be satisfied at a range of low temperature. Later we will also see that the requirements also extend to the energy level of the states, as the quasiparticle lifetime decreases as the energy deviate from the Fermi energy. 
%todo: can refer to the chapter where we talk about the lifetime decay with simulation. 
Therefore, Landau's theory of Fermi liquid postulated that an interacting fermionic system can we mapped adiabatically to a non-interacting Fermi gas, with long-lived quasiparticle that shares the same quantum numbers near the Fermi surface. It works in a regime with weak to moderate correlations at sufficiently low temperatures, and thus why worked extremely well in explaining properties in simple and noble metals. For more detailed reading regarding the theory, the textbooks of Pines and Nozieres\cite{nozieresTheoryQuantumLiquids2018a} Nozieres \cite{nozieresDerivationLandauTheory1962} offers derivations and in depth discussions. 

Landau's theory failed to address more involved systems, however, based on the theory, scientists managed to formulate a more generalized concept of quasiparticle through the lens of Green's function scheme of many-body theory. There are many extensions and refinements of quasiparticle theory throughout history, the meaning of quasiparticles adn the corresponding regime that this can be applied varied drastically. Here I would like to provide a rought list of those theories chronologically and give brief notes on them:
\begin{itemize}
	\item\textbf{Hatree-Fock Approximation (HF)} (1930s)
	HF approximation is not an extension of Fermi liquid theory but it is the first step beyond a purely free-electron model, and it lays groundwork for diagrammatic expansions \cite{fockNaeherungsmethodeZurLoesung1930}, \cite{slaterNoteHartreesMethod1930}.
	
	\item\textbf{Random Phase Approximation(RPA)} (1950s): 
	RPA extends the theory to moderate correlations where long-range screening is crucial, included dynamical screening. Successfully explains quasiparticle dispersion like plasmon dispersion and optical properties in metals and semiconductors \cite{bohmCollectiveDescriptionElectron1951}, \cite{nozieresCorrelationEnergyFree1958}.
	
	\item \textbf{BCS theory} (1957)
	BCS theory of superconductivity extends Fermi liquid theory by explicitly incorporating second-order phase transitions with an order parameter $\Delta$. For $T>T_c$, one can describe the normal state low temperature excitations with landau quasiparticles, these quasiparticle is unstable approaching $T_c$ and forms Copper pairs that breaks gauge symmetry and lead to superconducting phase. In the superconducting phase, the low energy excitations can be described by Bogoliubov quasiparticles, and since the excitations are gapped by a pairing gap $\Delta_k$. Bogoliubov quasiparticles thus have a finite energy and therefore are well defined and long-lived in a clean superconductor \cite{bardeenTheorySuperconductivity1957},\cite{tinkhamIntroductionSuperconductivity2004}.
 
	\item\textbf{GW Approximation} (1965)
	GW approximation provided a more accurate approximation than RPA and can be implemented to stronger correlated systems \cite{hedinNewMethodCalculating1965}, \cite{aryasetiawanGWMethod1998}.
	
	\item\textbf{Dynamical Mean-Field Theory(DMFT)} (1990s)
	DMFT was developed via a non-perturbative approach, this allows it to extend the concept of quasiparticles to account for strong local correlations in systems like transition metal oxides and f-electron materials. Although it kept the concpt of quasiparticles, it showed that they failed near Mott transitions when electron-electron interaction is large enough \cite{metznerCorrelatedLatticeFermions1989}, \cite{georgesDynamicalMeanfieldTheory1996}.
	
	\item\textbf{GW + DMFT} (2000s)
	This combined method took the best of GW(dynamic and non-local screening) with DMFT(local, but exact correlation), making it suitable for systems with moderate to strong correlation as well as significant screening effects, like heavy fermion compounds \cite{biermannFirstprinciplesApproachElectronic2003}.
\end{itemize}

A more detailed trace of the development of quasiparticle theory and its more recent application into systems like topological materials can be found in review paper \cite{wolfleQuasiparticlesCondensedMatter2018}. 

\subsection{Microscopic Theory of Quasiparticles}
Landau quasiparticles are added to a system with the creation of the excitations, therefore, we need to look at the retarted Green's function $G^R$ as it measures the density of states for adding particles, and thus a system's response to creating or annihilating a single fermion at a given state. We consider the one-particle retarded Green's function: 
\begin{equation}\label{retardedgreen}
	G^R_{k \sigma, \omega} = \frac{1}{\omega -\epsilon_k - \Sigma^R(k \sigma, \omega)},
\end{equation}
where $\epsilon_k= \frac{k^2}{2m-\mu}$ is the free electron energy with respect to the chemical potential $\mu$, and $\Sigma^R_{k \sigma, \omega}$ is the retarded self-energy that is irreducible in diagrammatic expansion. 

We then expand the self-energy into real and imaginary part, the effective single-electron energy is $\epsilon'_{k} = \epsilon_k + \operatorname{Re}\Sigma^R(k,\omega)$, we can then define the renormalized Fermi momentum $k^*_{F}$ as $\epsilon'_{\tilde{k_{F}}} = 0$. Then we expand $G^R_{k, \omega}$ around $k = k^*_{F}$ and get: 

\begin{equation}
\label{gr_full}
G^{R}(\mathbf{k}, \omega) \approx Z \left[ \omega - \epsilon^*_{\mathbf{k}} + i \Gamma_{\mathbf{k}} \right]^{-1}
\end{equation}
where
\begin{align} 
	Z^{-1} &= 1 - \left. \frac{\partial}{\partial \omega} \, \mathrm{Re} \, \Sigma (k^*_{F}, \omega) \right|_{\omega = 0}, 
	\\ 
	\label{eq2}
	\epsilon^*_{\mathbf{k}} &= (k - k^*_{F}) Z \left. \frac{\partial}{\partial k} \left( \epsilon_{\mathbf{k}} + \mathrm{Re} \, \Sigma ({k}, 0) \right) \right|_{k = k^*_{F}}, \\ 
	\label{gamma}
	\Gamma_{\mathbf{k}} &= Z \mathrm{Im} \Sigma^{R}({k}, 0) 
\end{align}

Here, $\epsilon^*_{\mathbf{k}}$ is the renoramlized energy, $\Gamma_{\mathbf{k}}$ is the relaxation rate which is inverse proportional to the quasiparticle lifetime $\tau_{life}$, and $Z$ is called the weight factor of qausiparticles. We can further parameterize the renormalized energy with effective mass $m^*$: 
\begin{equation}\label{energy}
	\epsilon^*_{\mathbf{k}} = \frac{k^*_F(k-k^*_F)}{m^*}
\end{equation}
We can then plug \ref{energy} to \ref{eq2} and get: 

\begin{equation}
	\frac{m}{m^*} = Z(1 + \frac{m}{k^*_F}\frac{\partial}{\partial k}\operatorname{Re}\Sigma(k,0)|_{k = k^*_{F}})
\end{equation}

We can see that by introducing the retarded self-energy that encodes the interaction effects on single particles, we can describe the system near the modified Fermi momentum with quasiparticles. These quasiparticles are characterized by an effective mass $m^*$ that is dictated by the real part of self-energy and a lifetime $\tau_{life}$ that is inversely proportional to the imaginary part of self-energy. Providing the imaginary part of self-energy very small, we have long lived quasiparticles, and hence we can write the Spectral function from \ref{gr_full}:
\begin{equation}
	\label{eq.akw}
	A(\textbf{k},\omega) = -2\operatorname{Im}G^R(\textbf{k}, \omega) 
	\approx 2\pi Z\delta(\omega-\epsilon^*_\textbf{k}) 
\end{equation}

This indicate a sharp peak at $\omega=\epsilon^*_\textbf{k}$, thus resembles the spectral function of a Fermi gas, and the pole is what we call the quasiparticle in the Fermi liquid theory. However, we can see that \ref{eq.akw} does not fulfill the normalization rule: 
\begin{equation}
	\int_{-\infty}^{+\infty} \frac{d\omega}{2\pi} A(\textbf{k},\omega) = 1, 
\end{equation}

we need to incorporate another term $A'(\textbf{k},\omega)$ into $ A(\textbf{k},\omega)$ to that has an integrated wight given by 1-Z, giving us: 
\begin{equation}
	\label{eq.akw}
	A(\textbf{k},\omega) = 2\pi Z\delta(\omega-\epsilon^*_\textbf{k}) + A'(\textbf{k},\omega)
\end{equation}
Fig. \ref{fig:ch5_spect} \cite{bruusManyBodyQuantum2004} illustrates this affect, and that term $A'(\textbf{k},\omega)$ captures the remaining excitations other than the well defined quasiparticle pole. 

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{Ch5_spectralfunciton.png}
	\caption{The spectral function $A(\textbf{k},\omega)$ that includes the quasiparticle peak and the background function $A'(\textbf{k},\omega)$ stemming from other types of excitation}
	\label{fig:ch5_spect}
\end{figure}

\subsection{Quasiparticle interference}

In the picture of Fermi liquid theory, interactive many-particle system is modeled by a renormalized single-particle system, with quasiparticles capturing the excitations near the renormalized Fermi level. These quasiparticles are long-living and carry the same quantum numbers $(\textbf{k}, \sigma)$ with the bare particles. The non-infinite lifetime correspond to the weakly interactive nature of the quasiparticles, interactions involved quasiparticles include quasiparticles-quasiparticle interaction of the same kind, e.g phonon-phonon interaction in anharmonic lattices \cite{bibid}; quasiparticles of different kind, e.g exciton-phonon coupling in ZnO \cite{bibid}; or interact with other elements like impurities on the lattices \cite{avrahamQuasiparticleInterferenceStudies2018}. 

Some experimental techniques utilizes the interactive nature of the quasiparticle as a channel to explore characters like the renormalized energy dispersion $\epsilon^*(\textbf{k})$. In particular, \ac{STM} make use of the quasiparticle-impurity scattering to perform an experiment called Quasiparticle Interference measurement, which we will elaborate with the next section. 

\section{Introduction to Quasiparticle Interference measurement}

In principle, there is only one way to measure the single particle properties, and more specifically the spectral function $A(\textbf{k},\omega)$, that is to inject/remove an electron into/out of a many-body system, and the tunneling experiment is the most natural way to achieve this. 

As introduced in Ch.2, \ac{STM} can probe both the energy and spatial dimensions of the electron density of states, making it an ideal tool to study quasiparticles. One of the most powerful experiments we perform on \ac{STM} is call Quasiparticle Interference measurement, or \ac{QPI} measurement. This section aims to introduce \ac{QPI} measurement, exploring both its theoretical foundation as well as the experimental details. We will then point out challenges of performing and interpreting a good \ac{QPI} measurement. This should give a direct motivation for our next chapter, which introduced a method that we use to mitigate some of the challenges. 

\subsection{Terminology}
To set stage for the discussion in this chapter, we must make distinctions between the following terminologies: 
\begin{itemize}
	\item QPI: a physical phenomenon describing the scattering between quasiparticles and lattice imperfections.  
	\item QPI pattern: an interference pattern that can be observed by \ac{STM} on the surface of the material.
	\item QPI measurement: a measurement that measures the QPI patterns presented in systems that intrinsically host QPI. This hinted an assumption that the tunneling experiment did not induce the scattering, but act as a mere observer of this phenomenon.
\end{itemize}
%We should note that STM is not the only tool that can perform QPI measurement. In fact, interference of quasiparticles are reported across a wide literature in different systems using different techniques. For example,
%todo: to wirte different examples here, template as X used Y technique to detect G quasiparticle Interference pattern in Z system.: ranging from crystalline excitation like phonon in Si phononic crystals \cite{maldovan_phonon_2015}, electronic excitation like Bogoliubov quasiparticle in superconductors interference strongly\cite{homan_search_nodate}
I will then elaborate what these terms mean in the context of an STM study, and to reduce redundancy, in the following writing, QPI, QPI pattern and QPI measurement will be referred specifically to STM studies.

\subsection{QPI measurement in STM}
%todo: to plot a standard grid and its FFT here.
Understanding QPI pattern is the first step to understand QPI measurement. QPI pattern is the modulation of \ac{LDOS} due to quasiparticle-impurity scattering. The modulated \ac{LDOS} provides direct insight on the quasiparticle band structure. Imagine an ideal metal with no crystal imperfection, we know that the Landau quasiparticle has an eigenstate in real space described by a Bloch wavefunction: 

\begin{equation}
\psi(\mathbf{r}) = e^{i \mathbf{k} \cdot \mathbf{r}} u(\mathbf{r})
\label{eq:bloch}
\end{equation} 
where $k$ is the crystal momentum of the quasiparticle. And the electron \ac{LDOS} can be written as  
\begin{equation}
\text{LDOS}(E, \vec{r}) \propto \sum_k |\Psi_k(\vec{r})|^2 \delta(E - \varepsilon(k))
\label{eq:ldos}
\end{equation}

where  $\epsilon(k)$ is the renormalized energy dispersion of the Bloch state for different $\vec{k}$; Remark: from now on all the renormalized energy will be write directly as $\epsilon(k)$ unless otherwise mentioned. And if we plug Equation (\ref{eq:bloch}) into Equation (\ref{eq:ldos}), we see that $\text{LDOS}$ is translationally invariant at all Bravais-lattice-equivalent points. Thus why in ideal case, real space imaging technique like \ac{STM}, can not be used to measure $\epsilon(k)$. 

However, crystal imperfections as discussed in Ch.4 can help us introduce a momentum texture to the $\text{LDOS}(E, \vec{r})$. In low temperature STM, where the phonon modes and other excitation are rare or absent, lattice imperfections such as point defects can cause elastic scattering which mixes electronic eigenstates at different $\vec{k}$ but at the same energy, the interference between the incoming and outgoing wave forms a "standing wave" that act as a real space modulation in $\text{LDOS}(E)$ described as a impurity-induced Friedel oscillation\cite{benaFriedelOscillationsDecoding2016}. This spatial modulation in $\text{LDOS}$ is the QPI pattern that we refer to in STM studies. We can perform \ac{STS} measurement on the region that presents this QPI pattern, then perform Fourier transformation to the STS, we can observe this QPI pattern in the momentum space. This whole process of detecting QPI pattern and analyze it in momentum space is what we call a QPI measurement. 

We will show case this \ac{LDOS} modulation with a simulation on a toy model in the following section. 

\begin{figure}
	\centering
	\includegraphics[width=0.5\textwidth]{example-image-a} % Replace with your image file
	\caption{Friedel oscillation and QPI}
	\label{fig:example}
\end{figure}

\subsection{LDOS modulation simulation on a square lattice}

As mentioned in last section \ac{QPI} measurement is the Fourier transformed spatial \ac{STS} measurement, which is proportional to the \ac{LDOS}. Thus, to understand \ac{QPI} measurement, we must understand the origin of \ac{QPI} pattern and how it modifies \ac{LDOS}. Here, I present an investigation into the \ac{LDOS} modulation caused by point defects on a square lattice, this textbook exercise is inspired by work from Cheung et al \cite{cheungDictionaryLearningFouriertransform2020}.

\subsubsection{Theory}
We first consider a square lattice with lattice constant $a$, and model it through the single-electron \ac{TB} model considering only nearest-neighbor hopping. This hopping is characterized with a fixed negative number $t$ named hopping-parameter. We then place $N_d$ number of defects onto different lattice sites as a perturbation to the \ac{TB} Hamiltonian $H_0$. The total Hamiltonian can then be written as: 
$\hat{H} = \hat{H}_0 + \hat{H}_d$. $\hat{H}_d$ can be written as: 
\[
\hat{H}_d = \sum_{\alpha=1}^{N_d} E_\alpha \lvert \alpha \rangle \langle \alpha \rvert,
\] 
where $\alpha$ enumerates $\alpha^{th}$ defect located at $x_\alpha$, with energy $E_{\alpha}$ much smaller than hopping parameter $t$, we then write the \ac{TB} Hamiltonian and transfer it into momentum space:
\begin{align}
\hat{H}_0 = E_0 -t \sum_{j,\tau} (c_j^{+} c_{j+\tau} + c_{j+\tau}^{+} c_j) \label{h0_real} \\
\hat{H}_0 = E_0 -\sum_{k} \epsilon_k c_k^{+} c_k \label{h0_k} \\
\epsilon_k = -2t(cos(k_x a)+cos(k_y a)) \label{E_k}
\end{align}
Now we consider our measurable \ac{LDOS} $\rho(\mathbf{x},\omega)$:
\begin{equation}
\rho(\mathbf{x},\omega) = \rho^{0}(\mathbf{x},\omega) - \frac{1}{\pi} \operatorname{Im} \left[ \langle \mathbf{x} | \hat{G}_0 \hat{T} \hat{G}_0 |\mathbf{x} \rangle \right],
\label{ldos}
\end{equation}
where $\hat{G}_0$ and $\hat{T}$ are the \ac{BLGF} and the scattering T-matrix, respectively, according to the pertubative scattering theory. Since we are interested in the modulation of \ac{LDOS} caused by the defects, our actual observable is $\delta \rho(\mathbf{x}, \omega) \equiv \rho(\mathbf{x}, \omega) - \rho^{(0)}(\mathbf{x}, \omega)
$, which is the second term in Equation (\ref{ldos}).
To start, we need to compute the matrix element of \ac{BLGF} $G_0(\mathbf{x},\mathbf{x'},\omega)$:
\begin{align}
	G_0(\mathbf{x},\mathbf{x}';\omega) &= \langle \mathbf{x} | \hat{G}_0(\omega) | \mathbf{x}' \rangle, \\
\end{align}
where
\begin{align}
	\hat{G}_0(\omega) &= \int_{\text{BZ}} \mathrm{d}\mathbf{k} \, \frac{1}{\omega - \hat{H}_0} \lvert \mathbf{k} \rangle \langle \mathbf{k} \rvert \nonumber \\ 
	&= \int_{\text{BZ}} \mathrm{d}\mathbf{k} \, \frac{1}{\omega - E_\mathbf{k}} \lvert \mathbf{k} \rangle \langle \mathbf{k} \rvert,
\end{align}
where we have $\omega= \omega + i\epsilon$ to indicate the retarded green's function and to capture the analytic continuation. Then we remind ourselves that in 2D, $\langle \mathbf{k}|\mathbf{x} \rangle = (\frac{1}{\sqrt{2\pi}})^2 e^{-i\mathbf{k}\mathbf{x}}$, and plug the energy dispersion Equation (\ref{E_k}) in, we get: 
\begin{align}
	G_0(\mathbf{x}, \mathbf{x}') = 
	\frac{1}{(2\pi)^2} \frac{1}{2t} 
	\int_{\text{BZ}} \mathrm{d}\mathbf{k} \, 
	\frac{e^{i k_1 (x_1 - x_1')} e^{i k_2 (x_2 - x_2')}}{b + \left( \cos(k_1 a) + \cos(k_2 a) \right)}. 
\end{align}
where $b \equiv \frac{\omega+ i\epsilon-E_0}{2t}$ is a dimensionless parameter, to  we can then define a normalized position deviation $s_j \equiv \frac{1}{a}(x_j-x_j')$ and further reduced the matrix element to its final form: 
\begin{align}
	G_0(\mathbf{x}, \mathbf{x}') = 
	\frac{1}{(2\pi)^2} \frac{1}{2t a^2} 4 \, I_{\text{sq}} 
	\left( \frac{x_1 - x_1'}{a}, \frac{x_2 - x_2'}{a}, b \right) \label{blgf},
\end{align}
where
\begin{align}
	I_{\text{sq}}(s_1, s_2, b) \equiv 
	\int_0^\pi \int_0^\pi \mathrm{d}\phi_1 \, \mathrm{d}\phi_2 \, 
	\frac{\cos(s_1 \phi_1) \cos(s_2 \phi_2)}{b + \cos\phi_1 +b  \cos\phi_2} \label{Isq}.
\end{align}
Now we proceed to compute the matrix element of T-matrix, we know that: 
\begin{equation}
	\hat{T} = \hat{H_d} (\hat{I} - \hat{G_0}\hat{H_d})^{-1}.
\end{equation} 
And for locations $x_\alpha$, $x_\beta$ on defect sites $\alpha$ and $\beta$, we have: 
\begin{align}
	T_{\alpha\beta} &= \langle \alpha|\hat{H_d} (\hat{I} - \hat{G_0}\hat{H_d})^{-1} | \beta\rangle \\
	&= E_\alpha(\langle \alpha|\hat{I}|\beta\rangle - \langle \alpha|\hat{G_0}\hat{H_d}|\beta \rangle)^{-1} \\
	&= E_\alpha(\delta_{\alpha \beta} - E_\beta G_0(\mathbf{x_\alpha},\mathbf{x_\beta}))^{-1} \label{T_matrix_ele}.
\end{align}
Now with both matrix elements of the \ac{BLGF} and T-matrix, we can finally express $\delta\rho(\mathbf{x},\omega)$ as 
\begin{align}
	\delta\rho(\mathbf{x},\omega) &= - \frac{1}{\pi} \operatorname{Im} \left[ \langle \mathbf{x} | \hat{G}_0 \hat{T} \hat{G}_0 | \mathbf{x} \rangle \right] \\
	&= -\frac{1}{\pi} \operatorname{Im} \left[\sum_{\alpha, \beta=1}^{N_{\text{d}}} G_0(\mathbf{x}, \mathbf{x}_\alpha) T_{\alpha, \beta} G_0(\mathbf{x}_\beta, \mathbf{x})\right].
\end{align}
In single defect case, where $\mathbf{x_\alpha} = \mathbf{x_\beta} = \mathbf{x_d}$, we have: 
\begin{align}
	T(\mathbf{x_d},\omega) &= E_{\text{d}} \left( 1 - E_{\text{d}} G_0(\mathbf{x_d}, \mathbf{x_d}) \right)^{-1} \label{T_matrix_ele} \\
	&= \frac{1}{E_{\text{d}}^{-1} - G_0(\mathbf{x_d}, \mathbf{x_d}; \omega)},
\end{align}
and therefore: 
\begin{align}
	\delta\rho(\mathbf{x},\omega) &= - \frac{1}{\pi} \operatorname{Im}(\frac{G_0^2(\mathbf{x},\mathbf{x_d};\omega)}{E_d^{-1} - G_0(\mathbf{x_d},\mathbf{x_d};\omega)}) \label{singleldos}. 
\end{align}
And Equation (\ref{singleldos}) can be evaluated numerically with Equation (\ref{blgf}) and Equation (\ref{Isq}).

\subsubsection{Simulation result}
A repository for \ac{LDOS} simulation on the model described above is made and shared on this \hyperlink{https://github.com/Plswearpants/QPI_simulation}{github repository}

The setup of simulation is illustrated in \ref{fig:ch5_qpisim_demo}, a grid of $128x128$ in real space covering a $20x20$ lattice space indicated in orange dots. We can implant defects on different lattice sites, indicated in green dots. 

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{Ch5_QPIsim_demo.pdf}
	\caption{schematics for the simulation}
	\label{fig:ch5_qpisim_demo}
\end{figure}

A typical \ac{LDOS} map is shown in \ref{fig:ch5_single_scattering}, the image is cropped from a simulation where $\delta\rho$ was numerically computed at a $301x301$ grid chosen to overlap with the square lattice with $50x50$ sites, a single defect is placed on location $\mathbf{x_d}=0$, with defect energy $E_d$, hopping parameter $t$, onsite energy $E_0$, 41 energy slices are computed in an energy range of $(-0.5, 0.5)V$. 

Observations can be made on this simulation, in particular, we can see that:
1. The \ac{LDOS} modulation is featured by wave-like pattern similar to the Friedel oscillation we seen, and the pattern varies with energy.
2. The modulation is strongly correlated with the underlying lattice corrugation. 
3. Although the feature is decaying away from the defect location, the wave extend far into the space, indicating a relatively long life-time of this quasiparticle. And the life-time is especially long around the Fermi level.


\begin{figure}
	\centering
	\includegraphics[width=0.5\textwidth]{example-image-b} % Replace with your image file
	\caption{single defect scattering result, details: }
	\label{fig:ch5_single_scattering}
\end{figure}

\subsubsection{Single defect result}

\subsubsection{Multi defect result}
\begin{itemize}
	\item direct evaluation of $\delta\rho(\mathbf{x},\omega)$
	\item Convolution approach
\end{itemize} 
Estimating the multidefect result with convolution approach inherently makes assumption into the independent nature of scattering, which is only true for weak scattering and sparse impurity distributions. 

\subsubsection{Limitations and assumptions}


\subsubsection{the process}
\subsubsection{the result}


\input{Ch.5.2}
