\chapter{Quasiparticle Interference (QPI)}
%todo: to write the abstract of this chapter after finishing this chapter
%todo: to standardize the vector form in this chapter 
\section{Introduction to Quasiparticle}
A Quasiparticle is any long-lived, well-defined excitation in a system that behaves like a particle, it is a semi-classical term used to describe particle interactions in terms of renormalized single-particle excitation. In Fermionic systems, it corresponds to a sharp peak in the spectra function: 
	\[
	A(\mathbf{k}, \omega) = -\frac{1}{\pi} \frac{\operatorname{Im} \Sigma(\mathbf{k}, \omega)}{(\omega - \tilde{E}_{\mathbf{k}})^2 + [\operatorname{Im} \Sigma(\mathbf{k}, \omega)]^2},
	\]

This section aims to introduce the concept of a quasiparticle, first through a historical overview of the development of quasiparticle theory, relevant languages and terms will be established, as well as the assumptions and limitations of the theory; then we illustrate the concept quantitatively through a microscopic theory of landau quasiparticles. 

\subsection{The historical overview}
The development of a quasiparticle model for Fermionic systems started in 1940s, when Sommerfeld and Bethe\cite{SommerfeldBethe1933} developed a model for a non-interacting electron gas, also known as the 'Fermi gas', in which a series of important terms are introduced. Consider a system made of non-interacting electrons with momentum $k$ and spin $\sigma = 1/2$, which is in touch with an electron reservoir with chemical potential $\mu$. The occupation number follows the Fermi-Dirac distribution $n_{k,\sigma}=1/(1+e^{(k^2/(2m)-\mu)/T}))$. At $T=0$, the occupation thus has a sharp boundary known as the Fermi surface, in the momentum space confined by the Fermi wave number $k_f$, and the energy defined by the Fermi surface is called the Fermi energy. At non-zero temperature, electrons at the Fermi energy will start to be excited above the Fermi energy; this excitation can also be described in second-quantization by the creation of a quasiparticle with energy: $\epsilon_{k,sigma} = k^2/2m - \mu$. 

Sommerfeld's theory of the electron gas worked quite well in standard metallic systems, but the success was unexpected, as the model neglected the Coulomb interaction between electrons. In a metallic system where the electron separation is in the order of the lattice spacing, the Coulomb interaction is in the order of eV, which is much larger than other energy scales, say, the thermal excitation considered in the electron gas mode. 

In the late 1960s, Landau raised a theory of the Fermi liquid with a series of foundational papers\cite{Landau1956}\cite{Landau1957} to address that even in the presence of interactions, we can find fermionic excitations in these many-body systems, and describe these excitations with what is known as the Landau quasiparticles. By adding a time-variant interaction term, defined by time constant $\zeta$ to the non-interactive system, and constructing the system Hamiltonian as
\begin{equation}\label{adiabatic}
	H_{\zeta} = H_0 + H_{\text{int}} e^{-\zeta t}, \quad t > 0,
\end{equation}

By the principle of adiabatic continuity, Landau is able to bridge between the states of interactive and non-interactive systems. Consequently, the states describing the interactive system can now be reduced to states in the non-interactive system with the same quantum numbers $k, \sigma$. More specifically, as quoted from \textit{What is a Quasi-Particle?} by J.R.Schrieffer, "these many-body states are well characterized in terms of a set of elementary excitations, called quasi-particles, which for the interacting system play the same role as the excited electrons(above the Fermi surface) and the excited holes(below the Fermi surface) in the Independent-particle approximation(IPA)." 

Landau's quasiparticle is an extremely useful concept in computing the screening and the transport properties of an electron-gas-like system. However, we should emphasize that the theory is only valid with several assumptions:

For an adiabatic procedure to hold, time scale $\zeta$ in Equation \ref{adiabatic} should be bounded by two conditions: 1. rate of evolution should be small compared to the energy of the state: $\zeta << \epsilon_{k,\sigma}$, 2. the final bound state remains the same as the initial one, meaning the lifetime $\tau_{life}$ of the bound state should be long enough: $\tau_{life} >> \zeta^{-1}$. Therefore, $\zeta$ should suits: 
\begin{equation}
	\tau_{life}^{-1} << \zeta << \epsilon_{k,\sigma},
\end{equation}
since typical excited energy is in the order of temperature, and the lifetime is inversely proportional to $T^2$, we can also write:
\begin{equation}
	T^2 << \zeta << k_B T,
\end{equation}
This requirement can be satisfied at a range of low temperature. Later we will also see that the requirements also extend to the energy level of the states, since the quasiparticle lifetime decreases as energies deviate from the Fermi energy. 
%todo: can refer to the chapter where we talk about the lifetime decay with simulation. 
%Therefore, Landau's theory of Fermi liquid postulated that an interacting fermionic system can we mapped adiabatically to a non-interacting Fermi gas, with long-lived quasiparticle that shares the same quantum numbers near the Fermi surface. 
In electronic systems, the theory works in a regime with weak to moderate electron-electron correlations at sufficiently low temperatures, and thus, it succeeds in explaining the properties of simple and noble metals. For more detailed reading regarding the theory, the textbooks of Pines and Nozieres\cite{nozieresTheoryQuantumLiquids2018a} and Nozieres \cite{nozieresDerivationLandauTheory1962} offer derivations and in-depth discussions. 

Landau's theory failed to address more involved systems; however, based on the theory, scientists formulated a more generalized concept of quasiparticles through the lens of Green's function scheme of many-body theory. There have been many extensions and refinements of the quasiparticle theory throughout history; the meaning of quasiparticles and the corresponding regime where this can be applied varied drastically. Here, I would like to provide a rough list of those theories chronologically and give brief notes on them:
\begin{itemize}
	\item\textbf{Hartree-Fock Approximation (HF)} (1930s):
	HF approximation is not an extension of Fermi liquid theory but it is the first step beyond a purely free-electron model, and it lays groundwork for diagrammatic expansions \cite{fockNaeherungsmethodeZurLoesung1930}, \cite{slaterNoteHartreesMethod1930}.
	
	\item\textbf{Random Phase Approximation(RPA)} (1950s): 
	RPA extends the theory to moderate correlations where long-range screening is crucial, including dynamical screening. It successfully explains quasiparticle dispersion like plasmon dispersion and optical properties in metals and semiconductors \cite{bohmCollectiveDescriptionElectron1951}, \cite{nozieresCorrelationEnergyFree1958}.
	
	\item \textbf{BCS theory} (1957):
	BCS theory of superconductivity established a microscopic explanation for the superconducting phase transition, which was initially described macroscopically by Ginzburgâ€“Landau theory as a second-order phase transition with an order parameter $\Delta$. For $T>T_c$, one can describe the normal state low temperature excitations with landau quasiparticles, these quasiparticles are unstable approaching $T_c$ with a weak attractive interaction, as shown by Cooper\cite{cooperBoundElectronPairs1956}, and forms Copper pairs that breaks gauge symmetry and lead to superconducting phase. In the superconducting phase, the low energy excitations can be described by Bogoliubov quasiparticles. Since the excitations are gapped by a pairing gap $\Delta_k$; Bogoliubov quasiparticles have a finite energy and therefore are well defined and long-living in a clean superconductor \cite{bardeenTheorySuperconductivity1957},\cite{tinkhamIntroductionSuperconductivity2004}.
 
	\item\textbf{Gutzwiller(GW) Approximation} (1965):
	GW approximation provided a more accurate approximation than RPA and can be implemented to stronger correlated systems \cite{hedinNewMethodCalculating1965}, \cite{aryasetiawanGWMethod1998}.
	
	\item\textbf{Dynamical Mean-Field Theory(DMFT)} (1990s):
	DMFT was developed via a non-perturbative approach, this allows it to extend the concept of quasiparticles to account for strong local correlations in systems like transition metal oxides and f-electron materials. Although it kept the concpt of quasiparticles, it showed that they failed near Mott transitions when electron-electron interaction is large enough \cite{metznerCorrelatedLatticeFermions1989}, \cite{georgesDynamicalMeanfieldTheory1996}.
	
	\item\textbf{GW + DMFT} (2000s):
	This combined method took the best of GW(dynamic and non-local screening) with DMFT(local, but exact correlation), making it suitable for systems with moderate to strong correlation as well as significant screening effects, like heavy fermion compounds \cite{biermannFirstprinciplesApproachElectronic2003}.
\end{itemize}

A more detailed history of the development of the quasiparticle theory and its more recent application into systems like topological materials can be found in Peter et al.\cite{wolfleQuasiparticlesCondensedMatter2018}. 

\subsection{Microscopic Theory of Quasiparticles}
Landau quasiparticles are added to a system with the creation of the excitations, therefore, we need to look at the retarted Green's function $G^R$ as it measures the density of states for adding particles, and thus a system's response to creating or annihilating a single fermion at a given state. We consider the one-particle retarded Green's function: 
\begin{equation}\label{retardedgreen}
	G^R_{k \sigma, \omega} = \frac{1}{\omega -\epsilon_k - \Sigma^R(k \sigma, \omega)},
\end{equation}
where $\epsilon_k= \frac{k^2}{2m-\mu}$ is the free electron energy with respect to the chemical potential $\mu$, and $\Sigma^R_{k \sigma, \omega}$ is the retarded self-energy that is irreducible in diagrammatic expansion. 

We then expand the self-energy into real and imaginary parts, the effective single-electron energy is $\epsilon'_{k} = \epsilon_k + \operatorname{Re}\Sigma^R(k,\omega)$. We can then define the renormalized Fermi momentum $k^*_{F}$ as $\epsilon'_{\tilde{k_{F}}} = 0$. Then we expand $G^R_{k, \omega}$ around $k = k^*_{F}$ and get: 

\begin{equation}
\label{gr_full}
G^{R}(\mathbf{k}, \omega) \approx Z \left[ \omega - \epsilon^*_{\mathbf{k}} + i \Gamma_{\mathbf{k}} \right]^{-1}
\end{equation}
where
\begin{align} 
	Z^{-1} &= 1 - \left. \frac{\partial}{\partial \omega} \, \mathrm{Re} \, \Sigma (k^*_{F}, \omega) \right|_{\omega = 0}, 
	\\ 
	\label{eq2}
	\epsilon^*_{\mathbf{k}} &= (k - k^*_{F}) Z \left. \frac{\partial}{\partial k} \left( \epsilon_{\mathbf{k}} + \mathrm{Re} \, \Sigma ({k}, 0) \right) \right|_{k = k^*_{F}}, \\ 
	\label{gamma}
	\Gamma_{\mathbf{k}} &= Z \mathrm{Im} \Sigma^{R}({k}, 0) 
\end{align}

\noindent here, $\epsilon^*_{\mathbf{k}}$ is the renoramlized energy, $\Gamma_{\mathbf{k}}$ is the relaxation rate which is inverse proportional to the quasiparticle lifetime $\tau_{life}$, and $Z$ is called the weight factor of qausiparticles. We can further parameterize the renormalized energy with effective mass $m^*$: 
\begin{equation}\label{energy}
	\epsilon^*_{\mathbf{k}} = \frac{k^*_F(k-k^*_F)}{m^*}
\end{equation}
We can then plug \ref{energy} to \ref{eq2} and get: 

\begin{equation}
	\frac{m}{m^*} = Z(1 + \frac{m}{k^*_F}\frac{\partial}{\partial k}\operatorname{Re}\Sigma(k,0)|_{k = k^*_{F}})
\end{equation}

We can see that by introducing the retarded self-energy that encodes the interaction effects on single particles, we can describe the system near the modified Fermi momentum with quasiparticles. These quasiparticles are characterized by an effective mass $m^*$ that is dictated by the real part of self-energy and a lifetime $\tau_{life}$ that is inversely proportional to the imaginary part of self-energy. Providing the imaginary part of self-energy very small, we have long lived quasiparticles, and hence we can write the Spectral function from \ref{gr_full}:
\begin{equation}
	\label{eq.akw}
	A(\textbf{k},\omega) = -2\operatorname{Im}G^R(\textbf{k}, \omega) 
	\approx 2\pi Z\delta(\omega-\epsilon^*_\textbf{k}) 
\end{equation}

This indicate a sharp peak at $\omega=\epsilon^*_\textbf{k}$, thus resembles the spectral function of a Fermi gas, and the pole is what we call the quasiparticle in the Fermi liquid theory. However, we can see that \ref{eq.akw} does not fulfill the normalization rule: 
\begin{equation}
	\int_{-\infty}^{+\infty} \frac{d\omega}{2\pi} A(\textbf{k},\omega) = 1, 
\end{equation}

we need to incorporate another term $A'(\textbf{k},\omega)$ into $ A(\textbf{k},\omega)$ to that has an integrated wight given by 1-Z, giving us: 
\begin{equation}
	\label{eq.akw}
	A(\textbf{k},\omega) = 2\pi Z\delta(\omega-\epsilon^*_\textbf{k}) + A'(\textbf{k},\omega)
\end{equation}
Fig. \ref{fig:ch5_spect} \cite{bruusManyBodyQuantum2004} illustrates this effect, and that term $A'(\textbf{k},\omega)$ captures the remaining excitations other than the well defined quasiparticle pole. 

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{Ch5_spectralfunciton.png}
	\caption{The spectral function $A(\textbf{k},\omega)$ that includes the quasiparticle peak and the background function $A'(\textbf{k},\omega)$ stemming from other types of excitation}
	\label{fig:ch5_spect}
\end{figure}

\section{Introduction to Quasiparticle Interference}

In the Fermi liquid theory, an interactive many-particle system is modeled by a renormalized single-particle system, with quasiparticles capturing the excitations near the renormalized Fermi level. These quasiparticles are long-living and carry the same quantum numbers $(\textbf{k}, \sigma)$ as the bare particles. The non-infinite lifetime corresponds to the weakly interactive nature of the quasiparticles; interactions involved quasiparticles include quasiparticles-quasiparticle interaction of the same kind, e.g. the phonon-phonon interaction in anharmonic lattices \cite{kimExploringAnharmonicLattice2023}; quasiparticles of a different kind, e.g. the exciton-phonon coupling in ZnO \cite{mendelsbergPhotoluminescenceExcitonphononCoupling2011}; or interact with other elements like impurities on the lattices \cite{avrahamQuasiparticleInterferenceStudies2018}. 

One can utilize the interactions that involve quasiparticles as a channel to explore properties of matters. In particular, when it comes to single-particle properties, or more specifically, probing the spectral function $A(\textbf{k},\omega)$, the tunneling experiment is at a unique position because of its ability to both inject and remove an electron into and out of a many-body system.  

As \ac{STM} combines the ability to resolve both the spatial and energy dimensions of the electron density of states; We can perform a powerful measurement call Quasiparticle Interference measurement, or \ac{QPI} measurement. This section aims to introduce \ac{QPI} measurement, exploring both its theoretical foundation as well as the experimental details. We will then point out challenges of performing and interpreting a "good" \ac{QPI} measurement. This should give a direct motivation for our next chapter, which introduced a method that we use to mitigate some of the challenges. 

\subsection{Terminology}
To set stage for the discussion in this chapter, we must make distinctions between the following terminologies: 
\begin{itemize}
	\item QPI: The interference between the incoming quasiparticle and the outgoing quasiparticle in a scattering event between quasiparticles and lattice imperfections.  
	\item QPI pattern: an interference pattern that can be observed by \ac{STM} on the surface of the material.
	\item QPI measurement: a measurement that measures the QPI patterns presented in systems that intrinsically host QPI. This hinted an assumption that the tunneling experiment did not induce the scattering, but act as a mere observer of this phenomenon.
\end{itemize}
%We should note that STM is not the only tool that can perform QPI measurement. In fact, interference of quasiparticles are reported across a wide literature in different systems using different techniques. For example,
%todo: to wirte different examples here, template as X used Y technique to detect G quasiparticle Interference pattern in Z system.: ranging from crystalline excitation like phonon in Si phononic crystals \cite{maldovan_phonon_2015}, electronic excitation like Bogoliubov quasiparticle in superconductors interference strongly\cite{homan_search_nodate}
I will then elaborate what these terms mean in the context of an STM study, and to reduce redundancy, in the following writing, QPI, QPI pattern and QPI measurement will be referred specifically to STM studies.

\subsection{QPI measurement in STM}
%todo: to plot a standard grid and its FFT here.
Understanding QPI pattern is the first step to understand QPI measurement. QPI pattern is the modulation of \ac{LDOS} due to quasiparticle-impurity scattering. The modulated \ac{LDOS} provides direct insight on the quasiparticle band structure. Imagine an ideal metal with no crystal imperfection; we know that the Landau quasiparticle has an eigenstate in real space described by a Bloch wavefunction: 

\begin{equation}
\psi(\mathbf{r}) = e^{i \mathbf{k} \cdot \mathbf{r}} u(\mathbf{r})
\label{eq:bloch}
\end{equation} 
where $k$ is the crystal momentum of the quasiparticle. And the electron \ac{LDOS} can be written as  
\begin{equation}
\text{LDOS}(E, \vec{r}) \propto \sum_k |\Psi_k(\vec{r})|^2 \delta(E - \varepsilon(k))
\label{eq:ldos}
\end{equation}

where  $\epsilon(k)$ is the renormalized energy dispersion of the Bloch state for different $\vec{k}$; Remark: from now on all the renormalized energy will be write directly as $\epsilon(k)$ unless otherwise mentioned. And if we plug Equation (\ref{eq:bloch}) into Equation (\ref{eq:ldos}), we see that $\text{LDOS}$ is translationally invariant at all Bravais-lattice-equivalent points. Thus why in ideal case, real space imaging technique like \ac{STM}, can not be used to measure $\epsilon(k)$. 

However, crystal imperfections as discussed in Ch.4 can help us introduce a momentum texture to the $\text{LDOS}(E, \vec{r})$. In low temperature STM, where the phonon modes and other excitation are rare or absent, lattice imperfections such as point defects can cause elastic scattering which mixes electronic eigenstates at different $\vec{k}$ but at the same energy, the interference between the incoming and outgoing wave forms a "standing wave" that act as a real space modulation in $\text{LDOS}(E)$ described as a impurity-induced Friedel oscillation\cite{benaFriedelOscillationsDecoding2016}. This spatial modulation in $\text{LDOS}$ is the QPI pattern that we refer to in STM studies. We can perform \ac{STS} measurement on the region that presents this QPI pattern, then perform Fourier transformation to the STS, we can also view this QPI pattern in the momentum space, the q-space QPI pattern is directly related to the quasiparticle band strucutre. This whole process of detecting QPI pattern and analyze it in momentum space is what we call a QPI measurement. 

We will quantitatively showcase this \ac{LDOS} modulation with a simulation on a toy model in the following section. 

%\begin{figure}
%	\centering
%	\includegraphics[width=0.5\textwidth]{example-image-a} % Replace with your image file
%	\caption{Friedel oscillation and QPI}
%	\label{fig:example}
%\end{figure}

\subsection{LDOS modulation simulation on a square lattice}

As mentioned in last section \ac{QPI} measurement is achieved by taking spectroscopy measurements on a real-space region that presents QPI pattern; As \ac{STM} spectroscopy probes the \ac{LDOS}, We must therefore, understand the origin of \ac{QPI} pattern and how it modifies \ac{LDOS}. Here, I present an investigation into the \ac{LDOS} modulation caused by point defects on a square lattice, this textbook exercise is inspired by work from Cheung et al \cite{cheungDictionaryLearningFouriertransform2020}.

\subsubsection{Theory}
We first consider a square lattice with lattice constant $a$, and model it through the single-electron Tight-Binding model considering only nearest-neighbor hopping. This hopping is characterized with a fixed negative number $t$ named hopping-parameter. We then place $N_d$ number of defects onto different lattice sites as a perturbation to the \ac{TB} Hamiltonian $H_0$. The total Hamiltonian can then be written as: 
$\hat{H} = \hat{H}_0 + \hat{H}_d$. $\hat{H}_d$ can be written as: 
\[
\hat{H}_d = \sum_{\alpha=1}^{N_d} E_\alpha \lvert \alpha \rangle \langle \alpha \rvert,
\] 
where $\alpha$ enumerates $\alpha^{th}$ defect located at $x_\alpha$, with energy $E_{\alpha}$ much smaller than hopping parameter $t$, we then write the \ac{TB} Hamiltonian and transfer it into momentum space:
\begin{align}
\hat{H}_0 = E_0 -t \sum_{j,\tau} (c_j^{+} c_{j+\tau} + c_{j+\tau}^{+} c_j) \label{h0_real} \\
\hat{H}_0 = E_0 -\sum_{k} \epsilon_k c_k^{+} c_k \label{h0_k} \\
\epsilon_k = -2t(cos(k_x a)+cos(k_y a)) \label{E_k}
\end{align}
Now we consider our measurable \ac{LDOS} $\rho(\mathbf{x},\omega)$:
\begin{equation}
\rho(\mathbf{x},\omega) = \rho^{0}(\mathbf{x},\omega) - \frac{1}{\pi} \operatorname{Im} \left[ \langle \mathbf{x} | \hat{G}_0 \hat{T} \hat{G}_0 |\mathbf{x} \rangle \right],
\label{ldos}
\end{equation}
where $\hat{G}_0$ and $\hat{T}$ are the \ac{BLGF} and the scattering T-matrix, respectively, according to the pertubative scattering theory. Since we are interested in the modulation of \ac{LDOS} caused by the defects, our actual observable is $\delta \rho(\mathbf{x}, \omega) \equiv \rho(\mathbf{x}, \omega) - \rho^{(0)}(\mathbf{x}, \omega)
$, which is the second term in Equation (\ref{ldos}).
To start, we need to compute the matrix element of \ac{BLGF} $G_0(\mathbf{x},\mathbf{x'},\omega)$:
\begin{align}
	G_0(\mathbf{x},\mathbf{x}';\omega) &= \langle \mathbf{x} | \hat{G}_0(\omega) | \mathbf{x}' \rangle, \\
\end{align}
where
\begin{align}
	\hat{G}_0(\omega) &= \int_{\text{BZ}} \mathrm{d}\mathbf{k} \, \frac{1}{\omega - \hat{H}_0} \lvert \mathbf{k} \rangle \langle \mathbf{k} \rvert \nonumber \\ 
	&= \int_{\text{BZ}} \mathrm{d}\mathbf{k} \, \frac{1}{\omega - E_\mathbf{k}} \lvert \mathbf{k} \rangle \langle \mathbf{k} \rvert,
\end{align}
where we have $\omega= \omega + i\epsilon$ to indicate the retarded Green's function and to capture the analytic continuation. Then we remind ourselves that in 2D, $\langle \mathbf{k}|\mathbf{x} \rangle = (\frac{1}{\sqrt{2\pi}})^2 e^{-i\mathbf{k}\mathbf{x}}$, and plug the energy dispersion Equation (\ref{E_k}) in, we get: 
\begin{align}
	G_0(\mathbf{x}, \mathbf{x}') = 
	\frac{1}{(2\pi)^2} \frac{1}{2t} 
	\int_{\text{BZ}} \mathrm{d}\mathbf{k} \, 
	\frac{e^{i k_1 (x_1 - x_1')} e^{i k_2 (x_2 - x_2')}}{b + \left( \cos(k_1 a) + \cos(k_2 a) \right)}. 
\end{align}
where $b \equiv \frac{\omega+ i\epsilon-E_0}{2t}$ is a dimensionless parameter, the $\i\epsilon$ is used to defined the retarded green's function by creating a pole in the complex plane, it also produces a better analytical continuation. we can then define a normalized position deviation $s_j \equiv \frac{1}{a}(x_j-x_j')$ and further reduced the matrix element to its final form: 
\begin{align}
	G_0(\mathbf{x}, \mathbf{x}') = 
	\frac{1}{(2\pi)^2} \frac{1}{2t a^2} 4 \, I_{\text{sq}} 
	\left( \frac{x_1 - x_1'}{a}, \frac{x_2 - x_2'}{a}, b \right) \label{blgf},
\end{align}
where
\begin{align}
	I_{\text{sq}}(s_1, s_2, b) \equiv 
	\int_0^\pi \int_0^\pi \mathrm{d}\phi_1 \, \mathrm{d}\phi_2 \, 
	\frac{\cos(s_1 \phi_1) \cos(s_2 \phi_2)}{b + \cos\phi_1 +b  \cos\phi_2} \label{Isq}.
\end{align}
Note that in the actual numerical calculation, the integral will be evaluated on an n by n grid of k-points.  
Now we proceed to compute the matrix element of T-matrix, we know that: 
\begin{equation}
	\hat{T} = \hat{H_d} (\hat{I} - \hat{G_0}\hat{H_d})^{-1}.
\end{equation} 
And for locations $x_\alpha$, $x_\beta$ on defect sites $\alpha$ and $\beta$, we have: 
\begin{align}
	T_{\alpha\beta} &= \langle \alpha|\hat{H_d} (\hat{I} - \hat{G_0}\hat{H_d})^{-1} | \beta\rangle \\
	&= E_\alpha(\langle \alpha|\hat{I}|\beta\rangle - \langle \alpha|\hat{G_0}\hat{H_d}|\beta \rangle)^{-1} \\
	&= E_\alpha(\delta_{\alpha \beta} - E_\beta G_0(\mathbf{x_\alpha},\mathbf{x_\beta}))^{-1} \label{T_matrix_ele}.
\end{align}
Now with both matrix elements of the \ac{BLGF} and T-matrix, we can finally express $\delta\rho(\mathbf{x},\omega)$ as 
\begin{align}
	\delta\rho(\mathbf{x},\omega) &= - \frac{1}{\pi} \operatorname{Im} \left[ \langle \mathbf{x} | \hat{G}_0 \hat{T} \hat{G}_0 | \mathbf{x} \rangle \right] \\
	&= -\frac{1}{\pi} \operatorname{Im} \left[\sum_{\alpha, \beta=1}^{N_{\text{d}}} G_0(\mathbf{x}, \mathbf{x}_\alpha) T_{\alpha, \beta} G_0(\mathbf{x}_\beta, \mathbf{x})\right]. \label{multi_defect_eq}
\end{align}
In single defect case, where $\mathbf{x_\alpha} = \mathbf{x_\beta} = \mathbf{x_d}$, we have: 
\begin{align}
	T(\mathbf{x_d},\omega) &= E_{\text{d}} \left( 1 - E_{\text{d}} G_0(\mathbf{x_d}, \mathbf{x_d}) \right)^{-1} \label{T_matrix_ele} \\
	&= \frac{1}{E_{\text{d}}^{-1} - G_0(\mathbf{x_d}, \mathbf{x_d}; \omega)},
\end{align}
and therefore: 
\begin{align}
	\delta\rho(\mathbf{x},\omega) &= - \frac{1}{\pi} \operatorname{Im}(\frac{G_0^2(\mathbf{x},\mathbf{x_d};\omega)}{E_d^{-1} - G_0(\mathbf{x_d},\mathbf{x_d};\omega)}) \label{singleldos}. 
\end{align}
And Equation (\ref{singleldos}) can be evaluated numerically with Equation (\ref{blgf}) and Equation (\ref{Isq}).

\subsubsection{Simulation result}
A repository for \ac{LDOS} simulation on the model described above is made and shared on this \hyperlink{https://github.com/Plswearpants/QPI_simulation}{github repository}

The setup of simulation is illustrated in \ref{fig:ch5_qpisim_demo}, a grid of $128x128$ in real space covering a $20x20$ lattice space indicated in orange dots. We can implant defects on different lattice sites, indicated in green dots. 

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{Ch5_QPIsim_demo.pdf}
	\caption{schematics for the simulation, in the actual calculation, we place defect at locations defined by lattice points, and compute $\delta\rho(\textbf{x},\omega)$ at each spatial grid point (128 by 128 here)}
	\label{fig:ch5_qpisim_demo}
\end{figure}

We first performed a single defect calculation, where we place the defect at the center of a square lattice with $51\times51$ sites, $\delta\rho$ was numerically computed at a $301\times301$ grid chosen to overlap with the square lattice, with defect energy $E_d$, hopping parameter $t$, onsite energy $E_0$. In total, 41 energy slices are computed in an energy range of $(-0.5, 0.5)V$.  

Typical \ac{LDOS} maps at different energy are shown in \ref{fig:ch5_single_scattering}, the figures are plotted on a gray scale image with the contrast indicating the level of \ac{LDOS} modulation. From the figures, we can make several observations:
\begin{itemize}
	\item The \ac{LDOS} modulation is featured by wave-like pattern similar to the Friedel oscillation we seen, and the pattern varies with energy.
	\item 2. The modulation is strongly correlated with the underlying lattice corrugation. 
	\item 3. Although the feature is decaying away from the defect location, the wave extend far into the space, indicating a relatively long life-time of this quasiparticle. And the life-time is especially long around the Fermi level, this aligns with our understanding about the Landau quasiparticle. 
	\item 4. The pattern persists further for patterns near the Fermi level. 
\end{itemize}




\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{Ch5_singe_defect.png} % Replace with your image file
	\caption{$\delta\rho(\textbf{x},\omega)$ for single defect at the center of the 51 by 51 lattice grid with t = -0.2 and $\omega$ = 0.45, 0.20, -0.05 and -0.45 eV; the integrand size is defined by n = 300, $\epsilon = 1*10^{-3}$. }
	\label{fig:ch5_single_scattering}
\end{figure}

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{Ch5_multi_defect.png} 
	\caption{$\delta\rho(\textbf{x},\omega)$ for 5 randomly placed defect on the 51 by 51 lattice grid with t = -0.2 and $\omega$ = 0.45, 0.20, -0.05 and -0.45 eV; the integrand size is defined by n = 300, $\epsilon = 1*10^{-3}$. }
	\label{fig:ch5_multi_scattering}
\end{figure}

We also calculated multi-defect results, for this, the T-matrix is no longer a scalar but rather a real matrix capturing the correlation between defects. Numerical results are calculated with Equation \ref{multi_defect_eq}, and shown in Fig. \ref{fig:ch5_multi_scattering}, 5 defect locations are randomly selected on the lattice points, we can see that the interference pattern from different defect sources are more prominent on spots with clustered defects. 


\subsection{Interpretation of QPI}
Quasiparticle-impurity scatterings give arise to \ac{QPI}. Interpretations of \ac{QPI} can be quite involved in real materials, but all the factors to consider can be characterized into 2 aspects: 1. the detailed quasiparticle states, and 2. the characteristics of the impurity. We will illustrate these aspects with the system we established for the simulation above. 
 
As mentioned in the start of Ch5.2, quasiparticles carry the same quantum numbers ($\textbf{k}$,$\sigma$) as the bare particles; Therefore, in an electronic system, quasiparticle states are dictated by the system's band structure. For the 2D Tight-binding model with only nearest neighbor hopping that we considered, the energy dispersion $\epsilon_{\mathbf{k}}$ is a parabola in $k_x$ and $k_y$ as denoted in \ref{E_k} and plotted in \ref{fig:ch5_bs} a). In an elastic quasiparticle-impurity scattering process, given our impurity is non-magnetic, we have the incoming state $\Psi(\textbf{k}_i,\sigma)$ and outgoing state $\Psi(\textbf{k}_f,\sigma)$, where $E_{\textbf{k}_f} = E_{\textbf{k}_i}$. To enforce elastic scattering, we can take a constant energy slice at a given energy, this reveals all possible states at that energy; This slice is normally referred as a \ac{CEC} of that particular energy. While real life materials can possess more complicated selection rules, in a single band situation as we formulated here, any state on the \ac{CEC} can be an initial or a final state in the scattering process; Mathematically, to describe the scattering vector $\textbf{q} = \textbf{k}_f -\textbf{k}_i$, we can take a self-convolution of the \ac{CEC}, which we can easily calculate and plot; This self-convolution is often referred as the \ac{JDOS} at the corresponding energy. An example is given at an energy close to the Fermi level in b),c) of Fig \ref{fig:ch5_bs}. 
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{Ch5_BS_JDOS.png} 
	\caption{Band structure of 2D tight-binding square lattice with nearest neighbor hopping, a) 3D Energy dispersion in $\textbf{k}_x$ and $\textbf{k}_y$, b) Constant energy contour and c) Joint density of states at $E=0.075eV$}
	\label{fig:ch5_bs}
\end{figure}

The real space \ac{LDOS} modulation can now be interpreted, and we illustrate it with \ref{fig:ch5_ldos}. First, to focus us on the interference ripples, we suppress the features from the defect itself by apply a Gaussian masking at the defect location, a)-b). Then we apply the Fourier transform to get the \ac{QPI} map in reciprocal space as shown in c), the red dots in c) are the Bragg peaks of the system. As we know, the range in reciprocal space is inversely proportional to the real space resolution. Longer $\textbf{q}-space$ features correspond to high frequency features in the real space; In most materials, the wavelengths of ordering are confined by the lattice parameter, therefore, a common practice is truncate and keep the feature within the Bragg peaks, this gives us a closer look to the features as shown in d). 
\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{Ch5_LDOS_QPI.png} 
	\caption{Transfer QPI map from real-space to \textbf{q}-space, an example given at $E=0.075eV$, we first suppress the defect feature with a Gaussian mask at the red dot in a), this gives us b). We then apply 2D Fourier transformed to b) and get c), the red dots are indications of the Bragg peaks of the square lattice. d), \textbf{q}-space QPI map cropped within the Bragg peaks for better visibility of low-\textbf{q} features}
	\label{fig:ch5_ldos}
\end{figure}

We now make a direct comparison between the $\textbf{q}$-space \ac{QPI}, \ac{CEC} and \ac{JDOS}, as shown in Fig \ref{fig:ch5_compare}. We picked two $\textbf{q}$-vectors $\textbf{q}_1$ and $\textbf{q}_2$ in the $\textbf{q}$-space \ac{QPI}, by transferring them one to one into the \ac{CEC}, we can map two sets of initial and final momentum states. For each $\textbf{q}$-vector, we have $\textbf{q} = \textbf{k}_2 - \textbf{k}_1$. 
\begin{figure}
	\includegraphics[width=1.1 \textwidth]{Ch5_QPI_JDOS.png} 
	\centering
	\caption{Interpretation of scattering vectors in \textbf{q}-space QPI map. Two \textbf{q}-vectors at horizontal and diagonal directions are drawn from the center to the high-intensity spots in a). b) is the \ac{CEC} in \textbf{k}-space at the same energy as a), states are binary in the \ac{CEC}, the darker gray indicates the presence of a state and lighter gray indicates the absence of a state. 2 arrowed lines of the corresponding colors indicates the scattering process from state in $\textbf{k}_1$ to state in $\textbf{k}_2$. c).\ac{JDOS} at the same energy, arrowed lines are in-scale with the lines in a) and b).}
	\label{fig:ch5_compare}
\end{figure}

There are two features in $\textbf{q}$-space \ac{QPI} that are worth mentioning: First, nested \ac{CEC} creates more concentrated intensity in $\textbf{q}$-space \ac{QPI}. Nesting is a term given to an energy iso-surface where there are surfaces with even spacing. In a two-dimensional system, we say a \ac{CEC} is nested when we have pairs of lines that have the same separations; Scattering between the states living on these lines gives the same $\textbf{q}$-vector and thus a concentrated intensity there. We can see this effect more clearly with a comparison as shown in Fig \ref{fig:ch5_compare}; Compare a) and c), we have a less faceted contour in c), and the resulting $\textbf{q}$-space \ac{QPI} has more spread out intensity. 

\begin{table}
	\centering
	\begin{tabular}{|c|c|c|c|}
		\hline
		Energy (eV) & Width ($\pi/a$) & Width Uncertainty ($\pi/a$) & R-squared \\
		\hline
		-0.5 & 0.0661 & 0.0044 & 0.9689 \\
		-0.4 & 0.0496 & 0.0040 & 0.9715 \\
		-0.3 & 0.0383 & 0.0034 & 0.9724 \\
		-0.2 & 0.0300 & 0.0028 & 0.9767 \\
		-0.1 & 0.0274 & 0.0032 & 0.9814 \\
		\hline
		0.075 & 0.0201 & 0.0014 & 0.9964 \\
		0.1 & 0.0328 & 0.0145 & 0.8706 \\
		0.125 & 0.0214 & 0.0013 & 0.9958 \\
		0.2 & 0.0286 & 0.0065 & 0.9350 \\
		0.3 & 0.0311 & 0.0048 & 0.9635 \\
		0.4 & 0.0392 & 0.0051 & 0.9544 \\
		0.5 & 0.0516 & 0.0062 & 0.9451 \\
		\hline
	\end{tabular}
	\caption{Horizontal profile fitting results showing the width and its uncertainty (in units of $\pi/a$) along with the R-squared values for both positive and negative bias energies.}
	\label{tab:qpi_fit_results_combined}
\end{table}

Secondly, the quasiparticle lifetime decreases as we move away from the Fermi surface. Given the momentum dependence of $\operatorname{Im}{\Sigma_{\textbf{k},\sigma}(\omega+i \eta)}$ is negligible, which is usually true, the spectral function is a simple Lorentzian in $\textbf{k}$-space of width $\operatorname{Im}{\Sigma}$ \cite{wolfleQuasiparticlesCondensedMatter2018}; Therefore, the \textbf{q}-space quasiparticle peak is also a Lorentzian with its width approximated at 2$\operatorname{Im}{\Sigma}$. Note that $\operatorname{Im}{\Sigma}$ is inversely proportional to the quasiparticle lifetime $\tau_{life}$, thus, we can probe $\tau_{life}$ by analyzing the broadening of the quasiparticle peaks in $\textbf{q}$-space \ac{QPI} at different energies. As shown in \ref{fig:ch5qplifetime}, we first take a horizontal line profile on the \textbf{q}-space \ac{QPI} that goes through the center, then fit a Lorentzian function on the quasiparticle peak region shown in the green dots in b), we can extract the peak width with its uncertainty. We then apply this process through different energy slices, the results are presented in Table \ref{tab:qpi_fit_results_combined} and plotted in c) of Fig. \ref{fig:ch5qplifetime}. All fittings possess a R-square value greater than 0.90 except for $E=0.1$, we thus marked the datapoint red in the plot. Quasiparticle peaks broadened as the energy deviated from the Fermi energy, however, within the energy range investigated, we still observe very sharp quasiparticle peaks, indicating long-lived and well-defined quasiparticles. 



\begin{figure}
	\includegraphics[width=\textwidth]{Ch5_nesting.png} 
	\centering
	\caption{Comparison of nesting effect on 2 energy slices of \textbf{q}-space QPI map, a more faceted \ac{CEC} like a) gives a more concentrated intensity in the QPI map b), compare to the unfaceted \ac{CEC} like c) gives a more spread out intensity in d).}
	\label{fig:ch5_nest}
\end{figure}


\begin{figure}
	\includegraphics[width=\textwidth]{Ch5_qp_lifetime.pdf} 
	\centering
	\caption{Fitting quasiparticle peaks with Lorentzian and extract the width at different energy levels. a)-b) An illustration of the process, we first extract the horizontal profile of the QPI map, then we identify two peaks in the profile, by symmetry argument, we fit one peak with Lorentzian function. c) QPI peak width across different energies, we see that as energy moves away from the Fermi level, the peaks broaden and $\tau_{life}$ decreases.}
	\label{fig:ch5qplifetime}
\end{figure}

Finally, it is important to note that different defect configurations will result in different \ac{QPI} patterns. This is due to gauge-field phase sensitivity in \ac{QPI}. As a scattering process, the quasiparticle state not only exchanged momentum with the impurity, it also picks up an additional phase $\delta$ during the process; Thus, certain QPI peaks can be suppressed if the phase shift due to scattering mismatches the phase difference between the two states. Moreover, this relative phase depends on the nature of the defects, similar to the refractive phase picked up by photon changes for different interface material, different defects will suppress \ac{QPI} intensities in different ways, give arise to different \ac{QPI} patterns. 
%todo: maybe we can talk about the phase effect from impurity configuration. 


%Estimating the multidefect result with convolution approach inherently makes assumption into the independent nature of scattering, which is only true for weak scattering and sparse impurity distributions. 


\input{Ch.5.2}
